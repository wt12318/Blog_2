

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=light>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/DNA.png">
  <link rel="icon" href="/img/DNA.png">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="Wu Tao">
  <meta name="keywords" content="">
  
    <meta name="description" content="常用的 Linux Shell ，R 命令&#x2F;脚本和报错解决方法">
<meta property="og:type" content="article">
<meta property="og:title" content="Linux &amp; R Tips">
<meta property="og:url" content="http://example.com/2021/08/05/linux_tips/index.html">
<meta property="og:site_name" content="wutao&#39;s blog">
<meta property="og:description" content="常用的 Linux Shell ，R 命令&#x2F;脚本和报错解决方法">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://example.com/img/linux.jpg">
<meta property="article:published_time" content="2021-08-05T11:14:18.000Z">
<meta property="article:modified_time" content="2022-05-20T14:28:19.939Z">
<meta property="article:author" content="Wu Tao">
<meta property="article:tag" content="编程">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="http://example.com/img/linux.jpg">
  
  
  
  <title>Linux &amp; R Tips - wutao&#39;s blog</title>

  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/github-markdown-css@4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="/lib/hint/hint.min.css" />

  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css" />



<!-- 主题依赖的图标库，不要自行修改 -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_hj8rtnfg7um.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_kmeydafke9r.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  



  
<link rel="stylesheet" href="/css/custom.css">



  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"example.com","root":"/","version":"1.9.1","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"right","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"R","line_number":true,"lib":"highlightjs","highlightjs":{"style":"Stackoverflow Light","style_dark":"light"},"prismjs":{"style":"default","preprocess":true}},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":true,"follow_dnt":true,"baidu":null,"google":null,"gtag":null,"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":"A5lchRnum84Yumu5pVOSoVN8-MdYXbMMI","app_key":"runF3Mxw7648v64CISxiqMs8","server_url":null,"path":"window.location.pathname","ignore_local":false}},"search_path":"/local-search.xml"};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>

  
<meta name="generator" content="Hexo 5.4.2"></head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 70vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>wutao&#39;s blog</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="iconfont icon-home-fill"></i>
                首页
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/">
                <i class="iconfont icon-archive-fill"></i>
                归档
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/">
                <i class="iconfont icon-category-fill"></i>
                分类
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/">
                <i class="iconfont icon-tags-fill"></i>
                标签
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/">
                <i class="iconfont icon-user-fill"></i>
                关于
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              &nbsp;<i class="iconfont icon-search"></i>&nbsp;
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">&nbsp;<i
                class="iconfont icon-dark" id="color-toggle-icon"></i>&nbsp;</a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('/img/default.png') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="Linux &amp; R Tips"></span>
          
        </div>

        
          
  <div class="mt-3">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-author" aria-hidden="true"></i>
        Wu Tao
      </span>
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2021-08-05 19:14" pubdate>
          2021年8月5日 晚上
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          32k 字
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          271 分钟
        
      </span>
    

    
    
      
        <span id="leancloud-page-views-container" class="post-meta" style="display: none">
          <i class="iconfont icon-eye" aria-hidden="true"></i>
          <span id="leancloud-page-views"></span> 次
        </span>
        
      
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <!-- SEO header -->
            <h1 style="display: none">Linux &amp; R Tips</h1>
            
            <div class="markdown-body">
              
              <p>常用的 Linux Shell ，R 命令&#x2F;脚本和报错解决方法</p>
<span id="more"></span>

<h3 id="添加用户，改密码，改权限"><a href="#添加用户，改密码，改权限" class="headerlink" title="添加用户，改密码，改权限"></a>添加用户，改密码，改权限</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_">#</span><span class="language-bash">添加用户组dev</span><br>groupadd dev<br><span class="hljs-meta prompt_">#</span><span class="language-bash">添加libb用户，并归属于dev组</span><br>useradd -g dev libb<br><span class="hljs-meta prompt_">#</span><span class="language-bash">给libb用户改密码</span><br>passwd libb<br><span class="hljs-meta prompt_">#</span><span class="language-bash"><span class="hljs-comment">#更改文件权限</span></span><br>chown -R user:group filename<br>chown -R wt wt/ ##改变文件主<br>chmod -R 741 wt/ ##3个数字分别表示User、Group、及Other的权限。 r=4，w=2，x=1<br></code></pre></td></tr></table></figure>

<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_">#</span><span class="language-bash"><span class="hljs-comment">#查看用户</span></span><br>cat /etc/passwd|grep -v nologin|grep -v halt|grep -v shutdown|awk -F&quot;:&quot; &#x27;&#123; print $1&quot;|&quot;$3&quot;|&quot;$4 &#125;&#x27;|more<br></code></pre></td></tr></table></figure>

<h3 id="动态库无法载入"><a href="#动态库无法载入" class="headerlink" title="动态库无法载入"></a>动态库无法载入</h3><p>有时候在 R 里面加载包会出现下面的报错：</p>
<blockquote>
<p>Error: package or namespace load failed for ‘NeoEnrichment’ in dyn.load(file, DLLpath &#x3D; DLLpath, …): unable to load shared object ‘&#x2F;home&#x2F;public&#x2F;R&#x2F;library&#x2F;Rsamtools&#x2F;libs&#x2F;Rsamtools.so’: &#x2F;lib64&#x2F;libstdc++.so.6: version &#96;GLIBCXX_3.4.20’ not found (required by &#x2F;home&#x2F;public&#x2F;R&#x2F;library&#x2F;Rsamtools&#x2F;libs&#x2F;Rsamtools.so)</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_">#</span><span class="language-bash"><span class="hljs-comment">#错误提示在/lib64/libstdc++.so.6中无法找到GLIBCXX_3.4.20，所以先检查一下/lib64/libstdc++.so.6 链接的库</span></span><br>strings /usr/lib64/libstdc++.so.6 | grep GLIBCXX<br>GLIBCXX_3.4<br>GLIBCXX_3.4.1<br>GLIBCXX_3.4.2<br>GLIBCXX_3.4.3<br>GLIBCXX_3.4.4<br>GLIBCXX_3.4.5<br>GLIBCXX_3.4.6<br>GLIBCXX_3.4.7<br>GLIBCXX_3.4.8<br>GLIBCXX_3.4.9<br>GLIBCXX_3.4.10<br>GLIBCXX_3.4.11<br>GLIBCXX_3.4.12<br>GLIBCXX_3.4.13<br>GLIBCXX_3.4.14<br>GLIBCXX_3.4.15<br>GLIBCXX_3.4.16<br>GLIBCXX_3.4.17<br>GLIBCXX_3.4.18<br>GLIBCXX_3.4.19<br>GLIBCXX_DEBUG_MESSAGE_LENGTH<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_">#</span><span class="language-bash"><span class="hljs-comment">#然后再在别的地方找找有么有</span></span><br>sudo find / -name &quot;libstdc++.so.6*&quot;<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_">#</span><span class="language-bash"><span class="hljs-comment">#检查一下</span></span><br>ll 有需要版本的GLIBCXX的库<br><span class="hljs-meta prompt_">#</span><span class="language-bash"><span class="hljs-comment">#将有需要版本的GLIBCXX的库替换掉/lib64/libstdc++.so.6就行了</span></span><br></code></pre></td></tr></table></figure>

<p>参考：[搞定 libstdc++.so.6: version &#96;GLIBCXX_3.4.21’ not found_phd的专栏-CSDN博客](<a target="_blank" rel="noopener" href="https://blog.csdn.net/phdsky/article/details/84104769">https://blog.csdn.net/phdsky/article/details/84104769</a>)</p>
<h3 id="安装-miniconda-和-mamba"><a href="#安装-miniconda-和-mamba" class="headerlink" title="安装 miniconda 和 mamba"></a>安装 miniconda 和 mamba</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs shell">wget https://mirrors.tuna.tsinghua.edu.cn/anaconda/miniconda/Miniconda3-py39_4.9.2-Linux-x86_64.sh<br>bash Miniconda3-py39_4.9.2-Linux-x86_64.sh<br><span class="hljs-meta prompt_">#</span><span class="language-bash"><span class="hljs-comment">#重启</span></span><br>conda install mamba -n base -c conda-forge<br>mamba install -c conda-forge htop<br>conda create -n your_env_name python=x.x<br></code></pre></td></tr></table></figure>

<h3 id="设置-history-文件显示时间"><a href="#设置-history-文件显示时间" class="headerlink" title="设置 history 文件显示时间"></a>设置 history 文件显示时间</h3><p>更改前：</p>
<p><img src="https://picgo-wutao.oss-cn-shanghai.aliyuncs.com/img/image-20210816153240709.png" srcset="/img/loading.gif" lazyload></p>
<p>更改：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_">#</span><span class="language-bash"><span class="hljs-comment">#显示时间</span></span><br>HISTTIMEFORMAT=&quot;%d/%m/%y %T &quot;<br>source ~/.bash_profile<br><span class="hljs-meta prompt_">#</span><span class="language-bash"><span class="hljs-comment">#命令数量</span></span><br>HISTFILESIZE=100000<br><span class="hljs-meta prompt_"># </span><span class="language-bash">append to the <span class="hljs-built_in">history</span> file, don<span class="hljs-string">&#x27;t overwrite it</span></span><br>shopt -s histappend<br></code></pre></td></tr></table></figure>

<p>更改后：</p>
<p><img src="https://picgo-wutao.oss-cn-shanghai.aliyuncs.com/img/image-20210816153333074.png" srcset="/img/loading.gif" lazyload></p>
<h3 id="不改变时间戳移动文件"><a href="#不改变时间戳移动文件" class="headerlink" title="不改变时间戳移动文件"></a>不改变时间戳移动文件</h3><p>不改变时间戳（创建，更改文件的时间）在服务器间移动文件：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">scp -p <br></code></pre></td></tr></table></figure>

<h3 id="安装-HDF5Array-编译错误"><a href="#安装-HDF5Array-编译错误" class="headerlink" title="安装 HDF5Array 编译错误"></a>安装 HDF5Array 编译错误</h3><p>报错： <code>cannot find -lcrypto</code>:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs shell">/usr/bin/ld: cannot find -lcrypto<br>collect2: error: ld returned 1 exit status<br>make: *** [HDF5Array.so] Error 1<br>ERROR: compilation failed for package ‘HDF5Array’<br><br><br>[root@localhost ~]# ll /usr/lib64/libssl*<br>-rwxr-xr-x 1 root root 387696 Apr 28 09:40 /usr/lib64/libssl3.so<br>lrwxrwxrwx 1 root root     16 Jun  2 01:56 /usr/lib64/libssl.so.10 -&gt; libssl.so.1.0.2k<br>-rwxr-xr-x 1 root root 470376 Dec 16  2020 /usr/lib64/libssl.so.1.0.2k<br>[root@localhost ~]# ln -s /usr/lib64/libssl.so.1.0.2k /usr/lib64/libssl.so<br>[root@localhost ~]# ll /usr/lib64/libssl*<br>-rwxr-xr-x 1 root root 387696 Apr 28 09:40 /usr/lib64/libssl3.so<br>lrwxrwxrwx 1 root root     27 Jul 20 01:42 /usr/lib64/libssl.so -&gt; /usr/lib64/libssl.so.1.0.2k<br>lrwxrwxrwx 1 root root     16 Jun  2 01:56 /usr/lib64/libssl.so.10 -&gt; libssl.so.1.0.2k<br>-rwxr-xr-x 1 root root 470376 Dec 16  2020 /usr/lib64/libssl.so.1.0.2k<br>[root@localhost ~]# ln -s /usr/lib64/libcrypto.so.1.0.2k /usr/lib64/libcrypto.so<br></code></pre></td></tr></table></figure>

<h3 id="释放-swap-内存："><a href="#释放-swap-内存：" class="headerlink" title="释放 swap 内存："></a>释放 swap 内存：</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs shell">sync<br>swapoff -a<br>swapon -a<br>free -m<br></code></pre></td></tr></table></figure>

<h3 id="Win10-右键添加新建-markdown-文件"><a href="#Win10-右键添加新建-markdown-文件" class="headerlink" title="Win10 右键添加新建 markdown 文件"></a>Win10 右键添加新建 markdown 文件</h3><p>新建一个 txt 文件，填入以下内容:</p>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs txt">Windows Registry Editor Version 5.00<br><br>[HKEY_CLASSES_ROOT\.md]<br>@=&quot;markdown&quot;<br><br>[HKEY_CLASSES_ROOT\.md\ShellNew]<br>&quot;NullFile&quot;=&quot;&quot;<br><br>[HKEY_CLASSES_ROOT\markdown]<br>@=&quot;Blank Markdown file&quot;<br></code></pre></td></tr></table></figure>

<p>然后把后缀改成 <code>.reg</code> 双击 一路点是 就可以了</p>
<h3 id="xargs命令"><a href="#xargs命令" class="headerlink" title="xargs命令"></a><code>xargs</code>命令</h3><p>使用管道可以方便地将一个命令的输出作为下一个命令的输入，但是有些命令并不支持管道输入，如<code>ls</code>,<code>mkdir</code>等，这时就可以用<code>xargs</code>命令。</p>
<p><code>xargs</code>可以接受文件或者命令的输出，将其传递给其他命令，默认是<code>echo</code>；<code>xargs</code>可以将多行的输出转化成一行，这就是其可以将输出传递给其他命令的基础（当然也可以用不同的参数得到不同格式的输出），看几个例子：</p>
<h4 id="xargs和wc"><a href="#xargs和wc" class="headerlink" title="xargs和wc"></a><code>xargs</code>和<code>wc</code></h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs shell">ls *.gtf | xargs wc -l<br> 42252 1-6.gtf<br>   42252 1.gtf<br>       8 test.gtf<br>   84512 total<br>   <br><span class="hljs-meta prompt_">#</span><span class="language-bash"><span class="hljs-comment">#ls 将后缀为gtf的文件名给xargs ，xargs将这些文件名传给wc作为其参数</span></span><br></code></pre></td></tr></table></figure>

<h4 id="使用-p选项，在执行的时候会询问"><a href="#使用-p选项，在执行的时候会询问" class="headerlink" title="使用-p选项，在执行的时候会询问"></a>使用<code>-p</code>选项，在执行的时候会询问</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell">echo &#x27;one two three&#x27; | xargs -p touch<br><span class="hljs-meta prompt_"># </span><span class="language-bash"><span class="hljs-built_in">touch</span> one two three ?...y</span><br></code></pre></td></tr></table></figure>

<h4 id="使用-I选项，执行多个命令"><a href="#使用-I选项，执行多个命令" class="headerlink" title="使用-I选项，执行多个命令"></a>使用<code>-I</code>选项，执行多个命令</h4><p><code>-I</code>后面跟一个字符，在后面的命令中出现相同的字符会被替换掉：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">cat directories.txt | xargs -I [  echo [ ## [也可以是其他字符<br></code></pre></td></tr></table></figure>

<p>如果我们要同时执行多个命令，可以使用<code>sh -c</code>：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">cat directories.txt | xargs -I [ sh -c &#x27;echo [;mkdir [&#x27;<br></code></pre></td></tr></table></figure>

<p>用这个我们可以改变<code>xargs</code>传递的参数的位置（默认是最后一个参数）：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">ls *.jpg | xargs -n1 -I &#123;&#125; cp &#123;&#125; /data/images ##将当前目录下的所有jpg文件复制到/data/images<br></code></pre></td></tr></table></figure>

<h4 id="使用-n选项，复制文件到多个位置"><a href="#使用-n选项，复制文件到多个位置" class="headerlink" title="使用-n选项，复制文件到多个位置"></a>使用<code>-n</code>选项，复制文件到多个位置</h4><p><code>-n</code>后面接数字，表示一次传递的参数的数目。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs shell"> echo ./dir_one/ ./dir_two/ | xargs -n 1 cp -v *.gtf ##-v 报告复制过程<br> &#x27;1-6.gtf&#x27; -&gt; &#x27;./dir_one/1-6.gtf&#x27;<br>&#x27;1.gtf&#x27; -&gt; &#x27;./dir_one/1.gtf&#x27;<br>&#x27;test.gtf&#x27; -&gt; &#x27;./dir_one/test.gtf&#x27;<br>&#x27;1-6.gtf&#x27; -&gt; &#x27;./dir_two/1-6.gtf&#x27;<br>&#x27;1.gtf&#x27; -&gt; &#x27;./dir_two/1.gtf&#x27;<br>&#x27;test.gtf&#x27; -&gt; &#x27;./dir_two/test.gtf&#x27;<br></code></pre></td></tr></table></figure>

<h4 id="结合find使用"><a href="#结合find使用" class="headerlink" title="结合find使用"></a>结合<code>find</code>使用</h4><p>用 <code>rm</code> 删除太多的文件时候，可能得到一个错误信息：<code>/bin/rm Argument list too long</code>,用 <code>xargs </code>去避免这个问题:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">find . -type f -name &quot;*.log&quot; -print0 | xargs -0 rm -f<br></code></pre></td></tr></table></figure>

<h3 id="如何将和文件夹同名但是有后缀的文件一次全部移动到相应的文件夹"><a href="#如何将和文件夹同名但是有后缀的文件一次全部移动到相应的文件夹" class="headerlink" title="如何将和文件夹同名但是有后缀的文件一次全部移动到相应的文件夹"></a>如何将和文件夹同名但是有后缀的文件一次全部移动到相应的文件夹</h3><p><img src="https://raw.githubusercontent.com/wt12318/picgo/master/img/20200403174510.png" srcset="/img/loading.gif" lazyload></p>
<p>如何将<code>.pbs</code>文件一次全部移动到相应的文件夹，<code>cancer</code>文件中是这些<code>pbs</code>的名字,是下面的命令产生的：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">for i in ./*.pbs ;do basename $i;done &gt; cancer<br></code></pre></td></tr></table></figure>

<p>由于<code>xargs</code>默认将结果作为下个命令的最后的参数，所以：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">cat cancer |while read i;do basename $i .pbs | xargs -n 1 mv $i;done<br></code></pre></td></tr></table></figure>

<h3 id="一次得到所有癌症类型的样本名"><a href="#一次得到所有癌症类型的样本名" class="headerlink" title="一次得到所有癌症类型的样本名"></a>一次得到所有癌症类型的样本名</h3><p>我的所有癌症的<code>maf</code>文件都存在一个相应的文件夹中，怎么将这些文件夹中的样本名提取出来，就是去掉后缀名，对一个癌症可以这样做：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">for i in ./luad/*;do basename $i .maf;done &gt; luadsample.txt<br></code></pre></td></tr></table></figure>

<p>批量做：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_">#</span><span class="language-bash">!/bin/bash</span><br><br>for i in /public/home/wangshx/wt/tcga_pancancer_dcc_mafs_082115/mafs/maf/*<br>do <br>   for j in $i/*<br>   do <br>     basename $j .maf &gt;&gt; $(echo $i.txt)<br>   done<br>done<br><br></code></pre></td></tr></table></figure>

<h3 id="遍历文件每一行进行操作"><a href="#遍历文件每一行进行操作" class="headerlink" title="遍历文件每一行进行操作"></a>遍历文件每一行进行操作</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">cat success_submitted_list.txt |while read i ;do mv $i ./02 ;done<br></code></pre></td></tr></table></figure>

<h3 id="提取文件名并去掉后缀"><a href="#提取文件名并去掉后缀" class="headerlink" title="提取文件名并去掉后缀"></a>提取文件名并去掉后缀</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">for i in ./luad/*;do basename $i _out.txt;done &gt; sample<br></code></pre></td></tr></table></figure>

<h3 id="grep匹配"><a href="#grep匹配" class="headerlink" title="grep匹配"></a><code>grep</code>匹配</h3><p><code>grep</code>的基本模式是：<code>grep &#39;pattern&#39; file_to_search</code> 并且会打印出匹配上<code>pattern</code>的行</p>
<p><code>gerp</code>常用的参数有：</p>
<ul>
<li><p><code>grep -w</code> 匹配整个字符：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs shell">echo &#x27;my dog is brown&#x27; &gt; sample.txt<br><br>grep -w &#x27;dog&#x27; sample.txt ##my dog is brown<br>grep -w &#x27;do&#x27; sample.txt ##not output<br></code></pre></td></tr></table></figure>
</li>
<li><p><code>grep -i</code> 匹配时大小写不敏感</p>
</li>
<li><p><code>grep -v</code>返回不匹配的行</p>
</li>
<li><p><code>grep -o</code> 只返回匹配的字符，而不是一整行</p>
</li>
<li><p><code>grep -c</code> 对匹配的行进行计数，相当于：<code>grep &#39;pattern&#39; file | wc -l</code></p>
</li>
<li><p>一些参数返回匹配行的前&#x2F;后行：</p>
<ul>
<li><code>grep -A [n] </code> 返回匹配的行和之后的n行</li>
<li><code>grep -B [n]</code> 返回匹配的行和之前的n行</li>
<li><code>grep -C [n]</code> 返回匹配的行和之前的n行，之后的n行</li>
</ul>
</li>
<li><p><code>grep -f </code> 后面可以接一个文件，里面有多个要匹配的模式，一个模式一行，也就是：<code>grep -f patterns.txt file.txt</code></p>
</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">grep -v &quot;#&quot; 1.gtf | grep -v &quot;^$&quot; | wc -l ##除去注释行和空行之后的行数，因为`$`是行尾的标记<br></code></pre></td></tr></table></figure>

<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs shell">grep -v &#x27;^#&#x27; 1.gtf | awk &#x27;&#123;print $3, $5-$4+1&#125;&#x27; | head ##计算每种特征的长度<br>gene 1152<br>transcript 1152<br>exon 1152<br>CDS 1149<br>start_codon 3<br>stop_codon 3<br>gene 75<br>transcript 75<br>exon 75<br>CDS 72<br></code></pre></td></tr></table></figure>

<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs shell">grep -v &#x27;^#&#x27; 1.gtf | awk &#x27;&#123;print $3&#125;&#x27; | sort | uniq -c ##这个就是看gtf文件中的feature类型的数量<br>   7050 CDS<br>   7553 exon<br>   7126 gene<br>   6700 start_codon<br>   6692 stop_codon<br>   7126 transcript<br></code></pre></td></tr></table></figure>

<p>找出文件2中有而文件1中没有的行：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">grep -vf file1 file2<br></code></pre></td></tr></table></figure>

<h3 id="文件上下翻转和左右翻转"><a href="#文件上下翻转和左右翻转" class="headerlink" title="文件上下翻转和左右翻转"></a>文件上下翻转和左右翻转</h3><ul>
<li><p><code>tac</code> 文件上下翻转，也就是第一行变为最后一行，第二行 变成倒数第二行</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_">#</span><span class="language-bash"><span class="hljs-comment">#首先创建一个文本</span></span><br>touch taccommand<br>vi taccommand<br><span class="hljs-meta prompt_">#</span><span class="language-bash">first</span><br><span class="hljs-meta prompt_">#</span><span class="language-bash">second</span><br><span class="hljs-meta prompt_">#</span><span class="language-bash">third</span><br>cat taccommand | tac<br><span class="hljs-meta prompt_">#</span><span class="language-bash">third</span><br><span class="hljs-meta prompt_">#</span><span class="language-bash">second</span><br><span class="hljs-meta prompt_">#</span><span class="language-bash">first</span><br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_">#</span><span class="language-bash"><span class="hljs-comment">#我们也可以直接输入文本，使用&lt;&lt;命令</span></span><br>cat &lt;&lt;END | tac##&lt;&lt;后接的就是终止符,这种方式并不创建一个文本<br><br></code></pre></td></tr></table></figure>
</li>
<li><p><code>rev</code> 将每列反转，也就是将第一个字符变成最后一个</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs shell">cat &lt;&lt;a | rev<br><span class="hljs-meta prompt_">#</span><span class="language-bash">&gt; abcde</span> <br><span class="hljs-meta prompt_">#</span><span class="language-bash">&gt; xyz</span> <br><span class="hljs-meta prompt_">#</span><span class="language-bash">&gt; a</span><br><span class="hljs-meta prompt_">#</span><span class="language-bash">edcba</span> <br><span class="hljs-meta prompt_">#</span><span class="language-bash">zyx</span><br></code></pre></td></tr></table></figure></li>
</ul>
<h3 id="使用rename批量重命名"><a href="#使用rename批量重命名" class="headerlink" title="使用rename批量重命名"></a>使用<code>rename</code>批量重命名</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs shell">touch test1.fa test2.fa <br>rename &#x27;test&#x27; &#x27;new&#x27; test*.fa<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_">#</span><span class="language-bash"><span class="hljs-comment">#批量提取一定长度的文件名，不改变后缀，重命名</span></span><br>for i in *.pbs ; do rename `basename $i .pbs` `echo $&#123;i:0:8&#125;` $i ;done <br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_">#</span><span class="language-bash">也可以使用</span><br>rename &#x27;s/names/replace/&#x27; file<br></code></pre></td></tr></table></figure>

<h3 id="一些有用的快捷操作"><a href="#一些有用的快捷操作" class="headerlink" title="一些有用的快捷操作"></a>一些有用的快捷操作</h3><ul>
<li>! 加之前输入过的命令的前几个字母，快速获取前面的命令</li>
<li>回到命令的行首可以用<code>ctrl a</code>或者<code>home</code>键，回到行尾可以用<code>ctrl e</code>或者<code>end</code>键；比如我写好一个命令但是却不想运行了可以回到行首加上#再回车</li>
<li><code>!!</code>表示上一条命令</li>
<li>替换上一个命令中的字符，再运行一遍命令，用于需要对多个文件执行同样的命令，又不想写循环的情况，使用<code>:gs(global substitute)</code> 如：<code>!!:gs/test1/test2</code> 将上一条命令中的test1替换成test2再运行一次</li>
</ul>
<h3 id="标准输入，标准输出与标准错误"><a href="#标准输入，标准输出与标准错误" class="headerlink" title="标准输入，标准输出与标准错误"></a>标准输入，标准输出与标准错误</h3><p>主要是3个符号：<code>&lt;</code> <code>&gt;</code> <code>-</code>；标准输出与标准错误都是输出到屏幕上的；可以用<code>&gt;</code> 将标准输出重定向到某个文件；<code>2 &gt;&amp;1</code> 将标准错误重定向到标准输出，如果已经将标准输出定向到某个文件，那么这个命令可以将标准错误与标准输出定向到一个文件（<strong>Linux 终端用 2 表示标准错误，1 表示标准输出</strong>）；<code>&lt;</code>表示标准输入 后面接可以产生输出的命令 可以将输出转为输入；也可以用<code>-</code>表示标准输入，下面看一个例子：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_">#</span><span class="language-bash"><span class="hljs-comment">#我们先写一个脚本</span></span><br><span class="hljs-meta prompt_">#</span><span class="language-bash">!/bin/bash</span><br>echo &quot;i am std output&quot;<br>unexisted_command<br><br>bash stdout_error.sh<br><span class="hljs-meta prompt_">#</span><span class="language-bash">i am std output,这个就是标准输出</span><br><span class="hljs-meta prompt_">#</span><span class="language-bash">stdout_error.sh: line 4: unexisted_command: <span class="hljs-built_in">command</span> not found，这个就是标准错误</span><br><br>bash stdout_error.sh &gt; stdout_error.stdout##将标准输出重定向到文件，但是标准错误还会在屏幕上显示<br>bash stdout_error.sh &gt; stdout_error.stdout 2&gt; stdout_error.stderr#将输出和错误都重定向到文件，注意2和&gt;之间没有空格<br>bash stdout_error.sh &gt; stdout_error.stdout 2&gt;&amp;1 ##将输出和错误重定向到一个文件<br><br>cat &lt;&lt;END | diff - &lt;(echo &quot;1 2 3&quot; | tr &#x27; &#x27; &#x27;\n&#x27;) ##diff有两个输入，一个是上一个命令的输出，一个是&lt;后的输出,tr是用来替换字符的<br></code></pre></td></tr></table></figure>

<h3 id="解压"><a href="#解压" class="headerlink" title="解压"></a>解压</h3><h4 id="zip"><a href="#zip" class="headerlink" title="zip"></a>zip</h4><p>解压用<code>unzip</code> ,压缩用<code>zip</code></p>
<h4 id="gz"><a href="#gz" class="headerlink" title="gz"></a>gz</h4><p>解压用<code>gunzip</code>，压缩用<code>gzip</code></p>
<h4 id="tar-gz"><a href="#tar-gz" class="headerlink" title="tar.gz"></a>tar.gz</h4><p>一些参数：</p>
<ul>
<li><code>-c</code>压缩</li>
<li><code>-x</code>解压</li>
<li><code>-t</code>查看压缩包的文件名</li>
<li><code>-z</code>指定<code>.gz</code></li>
<li><code>-f</code>指定压缩和解压缩的文件名</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs shell">tar -zcv -f cp_folder.tar.gz cp_folder       #打包压缩文件夹（gzip格式）<br><br>tar -ztv -f cp_folder.tar.gz                 #查看压缩文件夹中的文件名（gzip格式）<br><br>tar -zxv -f cp_folder.tar.gz                 #打开包并解压缩（gzip格式）<br></code></pre></td></tr></table></figure>

<h4 id="bz2"><a href="#bz2" class="headerlink" title="bz2"></a>bz2</h4><p>压缩：<code>bzip2</code>;解压：<code>bunzip2</code></p>
<p>也可以用<code>tar</code> 使用<code>-j</code>参数调用bzip，如：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">tar -xjf a.tar.bz2<br></code></pre></td></tr></table></figure>

<h3 id="文件操作"><a href="#文件操作" class="headerlink" title="文件操作"></a>文件操作</h3><h4 id="文件生成"><a href="#文件生成" class="headerlink" title="文件生成"></a>文件生成</h4><p><code>seq()</code>生成序列</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs shell">seq 1 10 ##默认分割符为换行符\n<br>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>seq -s &quot; &quot; 1 2 10 #也可以指定分隔符和步长<br>1 3 5 7 9<br>cat &lt;(seq 0 3 17) &lt;(seq 3 6 18) &gt; text##用标准输入和标准输出<br>0<br>3<br>6<br>9<br>12<br>15<br>3<br>9<br>15<br></code></pre></td></tr></table></figure>

<h4 id="文件排序"><a href="#文件排序" class="headerlink" title="文件排序"></a>文件排序</h4><p>使用<code>sort</code>进行排序，常用参数有：</p>
<ul>
<li><code>-n</code> 数值排序</li>
<li><code>-r</code>逆序</li>
<li><code>-c</code> 检测文件是否已经排序</li>
<li><code>-k</code>指定使用哪几列排序</li>
<li><code>-m</code>合并排序好的文件</li>
<li><code>-u</code>删除重复行</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><code class="hljs shell">sort test ##直接排序<br>1<br>12<br>13<br>14<br>14<br>15<br>16<br>2<br>24<br>3<br>35<br>4<br><br> sort -n test ## 按照数值排序<br>1<br>2<br>3<br>4<br>12<br>13<br>14<br>14<br>15<br>16<br>24<br>35<br><br>sort test &gt; on_test<br>sort -n test &gt; n_test<br><br>sort -cn on_test ##注意用cn就表示检查是否按照数值排序的<br><span class="hljs-meta prompt_">#</span><span class="language-bash"><span class="hljs-built_in">sort</span>: on_test:9: disorder: 2</span><br>sort -cn n_test ##没有输出，表示排序了<br><br>sort -nu test<br>sort -n test | uniq##两种相同，都是将重复元素去掉<br>1<br>2<br>3<br>4<br>12<br>13<br>14<br>15<br>16<br>24<br>35<br><br>sort -n test | uniq -d##获取重复的行<br>14<br><br>sort -n test | uniq -c ##获取重复的行重复的次数<br>      1<br>      1 1<br>      1 2<br>      1 3<br>      1 4<br>      1 12<br>      1 13<br>      2 14<br>      1 15<br>      1 16<br>      1 24<br>      1 35<br></code></pre></td></tr></table></figure>

<h4 id="一个例子，fasta序列提取"><a href="#一个例子，fasta序列提取" class="headerlink" title="一个例子，fasta序列提取"></a>一个例子，<code>fasta</code>序列提取</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs shell">cat test.fasta<br><span class="hljs-meta prompt_">&gt;</span><span class="language-bash">SOX2</span><br>ACGAGGGACGCATCGGACGACTGCAGGACTGTC<br><span class="hljs-meta prompt_">&gt;</span><span class="language-bash">POU5F1</span><br>ACGAGGGACGCATCGGACGACTGCAGGACTGTC<br><span class="hljs-meta prompt_">&gt;</span><span class="language-bash">NANOG</span><br>CGGAAGGTAGTCGTCAGTGCAGCGAGTCCGT<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_">#</span><span class="language-bash"><span class="hljs-comment">#提取含有SOX2的序列信息</span></span><br>grep -A 1 &quot;SOX2&quot; test.fasta<br><span class="hljs-meta prompt_">&gt;</span><span class="language-bash">SOX2</span><br>ACGAGGGACGCATCGGACGACTGCAGGACTGTC<br><span class="hljs-meta prompt_">#</span><span class="language-bash"><span class="hljs-comment">#-A 1表示输出匹配的行和其后一行after</span></span><br></code></pre></td></tr></table></figure>

<p>也可以用<code>awk</code>来操作:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs shell">awk &#x27;BEGIN&#123;OFS=FS=&quot;\t&quot;&#125;&#123;if($0 ~ /&gt;/) &#123;name=$0;sub(&quot;&gt;&quot;,&quot;&quot;,name);&#125;\<br>else seq[name]=$0;&#125;END&#123;print &quot;&gt;SOX2&quot;; print seq[&quot;SOX2&quot;]&#125;&#x27; test.fasta<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_">#</span><span class="language-bash"><span class="hljs-comment">#$0 ~ /&gt;/ ~表示模式匹配的运算符，看这一行里面有没有&gt;</span></span><br><span class="hljs-meta prompt_">#</span><span class="language-bash"><span class="hljs-comment">#sub 是进行替换的：sub(要替换的部分，要替换成的部分，要替换的字符串</span></span><br><span class="hljs-meta prompt_">#</span><span class="language-bash"><span class="hljs-comment">#seq[name] 相当于一个字典，name就是key</span></span><br></code></pre></td></tr></table></figure>

<h3 id="判断某个文件夹下是否有某个文件名-在一个文件中-，如果有将其移动到另一个文件夹"><a href="#判断某个文件夹下是否有某个文件名-在一个文件中-，如果有将其移动到另一个文件夹" class="headerlink" title="判断某个文件夹下是否有某个文件名(在一个文件中)，如果有将其移动到另一个文件夹"></a>判断某个文件夹下是否有某个文件名(在一个文件中)，如果有将其移动到另一个文件夹</h3><p>首先要对含有文件名的文件进行遍历：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs shell">cat all.txt |<br>while read file_name;<br>do<br>...<br>done<br></code></pre></td></tr></table></figure>

<p>然后判断是否有某个文件</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_">#</span><span class="language-bash">!/bin/bash</span><br>cat SRR_Acc_List.txt |<br>while read file_name<br>do<br>	if [ -e ./fastq_gz_2/$&#123;file_name&#125;_1.fastq.gz ]<br>	then<br>		mv ./fastq_gz_2/$&#123;file_name&#125;_1.fastq.gz ./liu_2019<br>	else<br>		echo &quot;not exist: $file_name&quot;<br>	fi<br>done<br></code></pre></td></tr></table></figure>

<p>判断文件夹下是否有某个后缀的文件：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">for i in ./SRR*/;do file=$(ls $i/*.tmp 2&gt;/dev/null | wc -l);if [ $file != 0 ];then echo $i;fi;done ##判断是否有后缀为tmp的文件<br></code></pre></td></tr></table></figure>

<h3 id="删除空文件夹"><a href="#删除空文件夹" class="headerlink" title="删除空文件夹"></a>删除空文件夹</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_">#</span><span class="language-bash">!/bin/bash</span><br><br>for i in ./SRR*<br>do <br>a=$(ls $i | wc -l)<br>if [ $a -eq 0 ]<br>then <br>    rm -rf $i<br>fi<br>done<br></code></pre></td></tr></table></figure>

<h3 id="几个取整函数：ceiling-floor-trunc-round-signif"><a href="#几个取整函数：ceiling-floor-trunc-round-signif" class="headerlink" title="几个取整函数：ceiling ; floor ; trunc ; round; signif"></a>几个取整函数：ceiling ; floor ; trunc ; round; signif</h3><p><code>ceiling</code> 返回不小于该数字的最小整数，即向上取整</p>
<p><code>floor</code> 返回不大于该数字的最大整数，即向下取整</p>
<p><code>trunc</code> 返回距离0最近的整数，即向零取整</p>
<p><img src="https://raw.githubusercontent.com/wt12318/picgo/master/img/20200128111606.png" srcset="/img/loading.gif" lazyload></p>
<p><code>round</code> 采取<strong>四舍六入五成双</strong>的原则：</p>
<ul>
<li><code>&lt;=</code>4舍去</li>
<li><code>&gt;=</code>6进一位</li>
<li>五成双：<ul>
<li>当5后面有数字的时候，舍5进一位</li>
<li>当5后面没有数字的时候：<ul>
<li>当5前一位为奇数时，舍5进一位</li>
<li>当5前一位为偶数时，舍5不进位</li>
</ul>
</li>
</ul>
</li>
</ul>
<p><code>round</code>也可以指定保留小数点的位数：<code>round(x,digits=0)</code></p>
<p><code>signif</code> 保留有效数字，<code>signif(x,digits=6)</code> 默认保留6位</p>
<h3 id="安装github上的包"><a href="#安装github上的包" class="headerlink" title="安装github上的包"></a>安装<code>github</code>上的包</h3><p>首先使用<code>devtools</code>来安装：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs R">devtools<span class="hljs-operator">::</span>install_github<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;gadenbuie/regexplain&quot;</span><span class="hljs-punctuation">)</span><br></code></pre></td></tr></table></figure>

<p>结果报错，应该是网不行：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs R">Error<span class="hljs-operator">:</span> Failed to install <span class="hljs-string">&#x27;unknown package&#x27;</span> from GitHub<span class="hljs-operator">:</span><br>  Timeout was reached<span class="hljs-operator">:</span> <span class="hljs-punctuation">[</span>api.github.com<span class="hljs-punctuation">]</span> Resolving timed out after <span class="hljs-number">10000</span> milliseconds<br></code></pre></td></tr></table></figure>

<p>上github将包的zip下载下来，用devtools的本地安装：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs R">devtools<span class="hljs-operator">::</span>install_local<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;~/packages/regexplain-master.zip&quot;</span><span class="hljs-punctuation">)</span><br></code></pre></td></tr></table></figure>

<p>还是不行：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs R">Error<span class="hljs-operator">:</span> Failed to install <span class="hljs-string">&#x27;regexplain-master.zip&#x27;</span> from local<span class="hljs-operator">:</span><br>  Timeout was reached<span class="hljs-operator">:</span> <span class="hljs-punctuation">[</span>api.github.com<span class="hljs-punctuation">]</span> Resolving timed out after <span class="hljs-number">10000</span> milliseconds<br></code></pre></td></tr></table></figure>

<p>只能用一般的本地安装包的方法：先解压</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs R">install.packages<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;~/packages/regexplain-master/&quot;</span><span class="hljs-punctuation">,</span>repos<span class="hljs-operator">=</span><span class="hljs-literal">NULL</span><span class="hljs-punctuation">,</span>type<span class="hljs-operator">=</span><span class="hljs-string">&quot;source&quot;</span><span class="hljs-punctuation">)</span><br></code></pre></td></tr></table></figure>

<h3 id="配置国内-R镜像"><a href="#配置国内-R镜像" class="headerlink" title="配置国内 R镜像"></a>配置国内 R镜像</h3><p>使用 <code>usethis::edit_r_profile()</code> 打开 <code>.Rprofile</code>, 然后在末尾添加相应的镜像。</p>
<p><a target="_blank" rel="noopener" href="https://mirror.nju.edu.cn/help/bioconductor">南大</a>：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs R">options<span class="hljs-punctuation">(</span>BioC_mirror<span class="hljs-operator">=</span><span class="hljs-string">&quot;https://mirror.nju.edu.cn/bioconductor&quot;</span><span class="hljs-punctuation">)</span><br>options<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;repos&quot;</span> <span class="hljs-operator">=</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span>CRAN<span class="hljs-operator">=</span><span class="hljs-string">&quot;https://mirror.nju.edu.cn/CRAN/&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><br></code></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://mirrors.tuna.tsinghua.edu.cn/help/CRAN/">清华</a>：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs R">options<span class="hljs-punctuation">(</span>BioC_mirror<span class="hljs-operator">=</span><span class="hljs-string">&quot;https://mirrors.tuna.tsinghua.edu.cn/bioconductor&quot;</span><span class="hljs-punctuation">)</span><br>options<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;repos&quot;</span> <span class="hljs-operator">=</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span>CRAN<span class="hljs-operator">=</span><span class="hljs-string">&quot;https://mirrors.tuna.tsinghua.edu.cn/CRAN/&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><br></code></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://mirrors.ustc.edu.cn/help/">中科大</a>:</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs R">options<span class="hljs-punctuation">(</span>repos <span class="hljs-operator">=</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span>USTC<span class="hljs-operator">=</span><span class="hljs-string">&quot;https://mirrors.ustc.edu.cn/CRAN/&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><br></code></pre></td></tr></table></figure>

<p>如果改了镜像安装包时还是会出现下载失败，可以尝试修改 <code>download.file.method</code> (Rprofile):</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs R">options<span class="hljs-punctuation">(</span>download.file.method<span class="hljs-operator">=</span><span class="hljs-string">&quot;libcurl&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-comment">##添加到.Rprofile</span><br></code></pre></td></tr></table></figure>

<h3 id="翻转字符串"><a href="#翻转字符串" class="headerlink" title="翻转字符串"></a>翻转字符串</h3><p>参考：<a target="_blank" rel="noopener" href="https://www.r-bloggers.com/four-ways-to-reverse-a-string-in-r/">https://www.r-bloggers.com/four-ways-to-reverse-a-string-in-r/</a></p>
<p>翻转字符串是一项常见的操作，比如我们想要找与一条DNA序列的互补序列就需要用到翻转</p>
<p>先生成一个短序列：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs R">set.seed<span class="hljs-punctuation">(</span><span class="hljs-number">1</span><span class="hljs-punctuation">)</span><br>dna <span class="hljs-operator">&lt;-</span> paste<span class="hljs-punctuation">(</span>sample<span class="hljs-punctuation">(</span><span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-string">&quot;A&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;T&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;C&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;G&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> <span class="hljs-number">10</span><span class="hljs-punctuation">,</span> <br>                    replace <span class="hljs-operator">=</span> <span class="hljs-built_in">T</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> collapse <span class="hljs-operator">=</span> <span class="hljs-string">&quot;&quot;</span><span class="hljs-punctuation">)</span><br></code></pre></td></tr></table></figure>

<p>第一种方法：先用<code>strsplit()</code>将序列拆分成单个字符向量，再用<code>rev()</code>翻转向量，最后用<code>paste()</code>连起来：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs R">start <span class="hljs-operator">&lt;-</span> <span class="hljs-built_in">proc.time</span><span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span><br>splits <span class="hljs-operator">&lt;-</span> strsplit<span class="hljs-punctuation">(</span>dna<span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">[[</span><span class="hljs-number">1</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">]</span><br>reversed <span class="hljs-operator">&lt;-</span> rev<span class="hljs-punctuation">(</span>splits<span class="hljs-punctuation">)</span><br>final_result <span class="hljs-operator">&lt;-</span> paste<span class="hljs-punctuation">(</span>reversed<span class="hljs-punctuation">,</span> collapse <span class="hljs-operator">=</span> <span class="hljs-string">&quot;&quot;</span><span class="hljs-punctuation">)</span><br>end <span class="hljs-operator">&lt;-</span> <span class="hljs-built_in">proc.time</span><span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span><br><br>print<span class="hljs-punctuation">(</span>end <span class="hljs-operator">-</span> start<span class="hljs-punctuation">)</span><br><span class="hljs-comment">#  用户   系统   流逝 </span><br><span class="hljs-comment">#12.931  0.860 13.862 </span><br></code></pre></td></tr></table></figure>

<p>第二种方法：先用R 内置的<code>utf8ToInt()</code>将字符转化成整数向量，再用<code>rev()</code>进行翻转,最后再用<code>intToUtf8</code>转化成字符</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs R">utf8ToInt<span class="hljs-punctuation">(</span><span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-string">&quot;abc&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><br><span class="hljs-comment">#[1] 97 98 99</span><br><br>start <span class="hljs-operator">&lt;-</span> <span class="hljs-built_in">proc.time</span><span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span><br>final_result <span class="hljs-operator">&lt;-</span> intToUtf8<span class="hljs-punctuation">(</span>rev<span class="hljs-punctuation">(</span>utf8ToInt<span class="hljs-punctuation">(</span>dna<span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><br>end <span class="hljs-operator">&lt;-</span> <span class="hljs-built_in">proc.time</span><span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span><br><br>print<span class="hljs-punctuation">(</span>end <span class="hljs-operator">-</span> start<span class="hljs-punctuation">)</span><br><span class="hljs-comment">#用户  系统  流逝 </span><br><span class="hljs-comment">#1.569 0.538 2.136 </span><br></code></pre></td></tr></table></figure>

<p>第三种方法就是用<code>stringi</code>包的<code>stri_reverse</code>函数进行翻转：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs R">start <span class="hljs-operator">&lt;-</span> <span class="hljs-built_in">proc.time</span><span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span><br>final_result <span class="hljs-operator">&lt;-</span> stringi<span class="hljs-operator">::</span>stri_reverse<span class="hljs-punctuation">(</span>dna<span class="hljs-punctuation">)</span><br>end <span class="hljs-operator">&lt;-</span> <span class="hljs-built_in">proc.time</span><span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span><br><br>print<span class="hljs-punctuation">(</span>end <span class="hljs-operator">-</span> start<span class="hljs-punctuation">)</span><br><span class="hljs-comment"># 用户  系统  流逝 </span><br><span class="hljs-comment">#0.295 0.028 0.336 </span><br></code></pre></td></tr></table></figure>

<p>第四种方法就是使用<code>Biostrings</code>包里面的<code>str_rev()</code>函数：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs R"><span class="hljs-keyword">if</span><span class="hljs-punctuation">(</span>require<span class="hljs-punctuation">(</span>Biostrings<span class="hljs-punctuation">)</span><span class="hljs-operator">==</span><span class="hljs-built_in">F</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">&#123;</span><br>  BiocManager<span class="hljs-operator">::</span>install<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;Biostrings&quot;</span><span class="hljs-punctuation">)</span><br>  library<span class="hljs-punctuation">(</span>Biostrings<span class="hljs-punctuation">)</span><br><span class="hljs-punctuation">&#125;</span><span class="hljs-keyword">else</span><span class="hljs-punctuation">&#123;</span>library<span class="hljs-punctuation">(</span>Biostrings<span class="hljs-punctuation">)</span><span class="hljs-punctuation">&#125;</span><br>start <span class="hljs-operator">&lt;-</span> <span class="hljs-built_in">proc.time</span><span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span><br>final_result <span class="hljs-operator">&lt;-</span> str_rev<span class="hljs-punctuation">(</span>dna<span class="hljs-punctuation">)</span><br>end <span class="hljs-operator">&lt;-</span> <span class="hljs-built_in">proc.time</span><span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span><br><br>print<span class="hljs-punctuation">(</span>end <span class="hljs-operator">-</span> start<span class="hljs-punctuation">)</span><br><span class="hljs-comment"># 用户  系统  流逝 </span><br><span class="hljs-comment">#0.031 0.001 0.032 </span><br></code></pre></td></tr></table></figure>

<h3 id="Centos7-编译安装-R"><a href="#Centos7-编译安装-R" class="headerlink" title="Centos7 编译安装 R"></a>Centos7 编译安装 R</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><code class="hljs shell">wget https://mirrors.sjtug.sjtu.edu.cn/cran/src/base/R-4/R-4.1.0.tar.gz<br><br>sudo yum install gcc-c++<br>sudo yum -y install gcc-gfortran<br>sudo yum install readline-devel<br>sudo yum install zlib-devel<br>sudo yum install bzip2-devel<br>sudo yum -y install xz-devel.x86_64<br>sudo yum install pcre pcre-devel<br>sudo yum install libcurl libcurl-devel<br>sudo yum install pcre2 pcre2-devel<br>sudo yum install java-1.8.0-openjdk-devel.x86_64<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_">#</span><span class="language-bash"><span class="hljs-comment">#安装perl</span></span><br>sudo yum install perl*<br>cpan install XML::Simple<br>cpan install XML::LibXML<br>wget https://www.cpan.org/src/5.0/perl-5.34.0.tar.gz<br>tar zxf perl-5.34.0.tar.gz<br>./Configure -des -D -prefix=/usr/local/<br>make<br>make install<br><br>sudo yum install libpng-devel<br>sudo yum install libjpeg-devel<br>sudo yum install libtiff-devel<br>sudo yum install libcairo-devel<br>sudo yum search libcair<br>sudo yum search cairo<br>sudo yum install cairo-devel.x86_64<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_">#</span><span class="language-bash">configure: WARNING: you cannot build info or HTML versions of the R manuals</span><br><span class="hljs-meta prompt_">#</span><span class="language-bash">configure: WARNING: you cannot build PDF versions of the R manuals</span><br><span class="hljs-meta prompt_">#</span><span class="language-bash">configure: WARNING: you cannot build PDF versions of vignettes and <span class="hljs-built_in">help</span> pages</span><br><span class="hljs-meta prompt_">#</span><span class="language-bash"><span class="hljs-comment">#https://stackoverflow.com/questions/24983906/configure-warning-you-cannot-build-info-or-html-versions-of-the-r-manuals</span></span><br>sudo yum install texinfo.x86_64<br>sudo yum install texlive.x86_64<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_">#</span><span class="language-bash">configure: WARNING: neither inconsolata.sty nor zi4.sty found: PDF vignettes and package manuals will not be rendered optimally</span> <br>wget http://mirrors.ctan.org/fonts/inconsolata.zip<br><span class="hljs-meta prompt_">#</span><span class="language-bash">解压 ：</span><br>unzip inconsolata.zip <br><span class="hljs-meta prompt_">#</span><span class="language-bash">将文件拷贝到目录下：</span><br>cp -Rfp inconsolata/* /usr/share/texmf/<br><span class="hljs-meta prompt_">#</span><span class="language-bash">刷新sty ：</span><br>mktexlsr<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_">#</span><span class="language-bash"><span class="hljs-comment">#最后编译安装</span></span><br>./configure --with-cairo --enable-memory-profiling --enable-R-shlib <br>            --with-blas --with-lapack --prefix=/opt/R/4.1 -with-x=no<br>make<br>make install<br></code></pre></td></tr></table></figure>

<h3 id="设置了-SSH-key-但是-Github-push-仍然需要密码"><a href="#设置了-SSH-key-但是-Github-push-仍然需要密码" class="headerlink" title="设置了 SSH key 但是 Github push 仍然需要密码"></a>设置了 SSH key 但是 Github push 仍然需要密码</h3><p>设置了 SSH key 但是 Github push 仍然需要密码，而 github 在 8 月 13 后只支持已 token 的形式 push：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs shell">git push origin main<br>Username for &#x27;https://github.com&#x27;: wt12318<br>Password for &#x27;https://wt12318@github.com&#x27;:<br>remote: Support for password authentication was removed on August 13, 2021. Please use a personal access token instead.<br>remote: Please see https://github.blog/2020-12-15-token-authentication-requirements-for-git-operations/ for more information.<br>fatal: unable to access &#x27;https://github.com/wt12318/Blog_2.git/&#x27;: The requested URL returned error: 403<br></code></pre></td></tr></table></figure>

<p>需要输入密码是由于使用了 <code>https</code> 的 url，参考<a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/21095054/ssh-key-still-asking-for-password-and-passphrase">git - SSH Key - Still asking for password and passphrase - Stack Overflow</a>，所以需要从 <code>https</code> 转到 <code>ssh</code>:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs shell">git remote -v<br>origin  https://github.com/wt12318/Blog_2.git (fetch)<br>origin  https://github.com/wt12318/Blog_2.git (push)<br><br>git remote set-url origin git@github.com:wt12318/Blog_2.git<br>git remote -v<br>origin  git@github.com:wt12318/Blog_2.git (fetch)<br>origin  git@github.com:wt12318/Blog_2.git (push)<br><br>git push origin main<br></code></pre></td></tr></table></figure>

<h3 id="如何将-PPT-无损转成-PDF"><a href="#如何将-PPT-无损转成-PDF" class="headerlink" title="如何将 PPT 无损转成 PDF"></a>如何将 PPT 无损转成 PDF</h3><p>用 Office Powerpoint 打开 PPT （前提是电脑已经装了 Adobe Acrobat）。</p>
<p>首先点击 ACROBAT 插件首选项–高级设置进行设置：</p>
<img src="https://picgo-wutao.oss-cn-shanghai.aliyuncs.com/img/image-20210821102156796.png" srcset="/img/loading.gif" lazyload style="zoom:50%;" />

<p>接着将一般里面的对象级压缩和图像中三类图像的采样和压缩都关闭：</p>
<img src="https://picgo-wutao.oss-cn-shanghai.aliyuncs.com/img/image-20210821102401529.png" srcset="/img/loading.gif" lazyload style="zoom:50%;" />



<img src="https://picgo-wutao.oss-cn-shanghai.aliyuncs.com/img/image-20210821102503066.png" srcset="/img/loading.gif" lazyload style="zoom:50%;" />

<p>接着就可以确定并导出 PDF 了。一个好用的在线 PDF 编辑工具：<a target="_blank" rel="noopener" href="https://tools.pdf24.org/zh/">PDF24 Tools: 免费且易于使用的在线PDF工具</a></p>
<h3 id="如何使用-FTP-下载-ENA-的-FASTQ-数据"><a href="#如何使用-FTP-下载-ENA-的-FASTQ-数据" class="headerlink" title="如何使用 FTP 下载 ENA 的 FASTQ 数据"></a>如何使用 FTP 下载 ENA 的 FASTQ 数据</h3><p>先安装ftp服务（centos 7）：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">sudo yum -y install lftp<br></code></pre></td></tr></table></figure>

<p>没有权限的可以手动编译：<a target="_blank" rel="noopener" href="http://lftp.yar.ru/get.html">http://lftp.yar.ru/get.html</a></p>
<p>安装好了之后就可以使用ENA上的ftp地址进行下载，比如这里的CCLE的一个细胞系的RNA-seq数据：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">lftp ftp://ftp.sra.ebi.ac.uk/vol1/fastq/SRR861/006/SRR8615916 <span class="hljs-comment">##注意要加上ftp://</span><br></code></pre></td></tr></table></figure>

<p>ls 一下就可以看到我们要下载的数据：</p>
<p><img src="https://picgo-wutao.oss-cn-shanghai.aliyuncs.com/img/image-20210923093125983.png" srcset="/img/loading.gif" lazyload></p>
<p>然后使用 <code>pget</code> 就可以进行多线程下载了：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">pget -n 10 SRR8615916_1.fastq.gz<br></code></pre></td></tr></table></figure>

<p>下载速度还是比较快的：</p>
<p><img src="https://picgo-wutao.oss-cn-shanghai.aliyuncs.com/img/image-20210923093222640.png" srcset="/img/loading.gif" lazyload></p>
<h3 id="如何用-R-一次性读入一个文件夹下所有的文件并合并"><a href="#如何用-R-一次性读入一个文件夹下所有的文件并合并" class="headerlink" title="如何用 R 一次性读入一个文件夹下所有的文件并合并"></a>如何用 R 一次性读入一个文件夹下所有的文件并合并</h3><p>先生成一些文件：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs R">dir.create<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;test&quot;</span><span class="hljs-punctuation">)</span><br><span class="hljs-comment">##在 test 下生成一些csv文件</span><br>df <span class="hljs-operator">&lt;-</span> data.frame<span class="hljs-punctuation">(</span><br>  x<span class="hljs-operator">=</span><span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-number">1</span><span class="hljs-operator">:</span><span class="hljs-number">100</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><br>  y<span class="hljs-operator">=</span><span class="hljs-built_in">rep</span><span class="hljs-punctuation">(</span><span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-string">&quot;a&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;b&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;c&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;d&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span>each<span class="hljs-operator">=</span><span class="hljs-number">5</span><span class="hljs-punctuation">)</span><br><span class="hljs-punctuation">)</span><br>dt_list <span class="hljs-operator">&lt;-</span> split<span class="hljs-punctuation">(</span>df<span class="hljs-punctuation">,</span> <span class="hljs-built_in">list</span><span class="hljs-punctuation">(</span>df<span class="hljs-operator">$</span>y<span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><br><span class="hljs-keyword">for</span> <span class="hljs-punctuation">(</span>i <span class="hljs-keyword">in</span> <span class="hljs-built_in">names</span><span class="hljs-punctuation">(</span>dt_list<span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span> <span class="hljs-punctuation">&#123;</span><br>  write.csv<span class="hljs-punctuation">(</span>dt_list<span class="hljs-punctuation">[[</span>i<span class="hljs-punctuation">]</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span> paste0<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;test/&quot;</span><span class="hljs-punctuation">,</span>i<span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;.csv&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><br><span class="hljs-punctuation">&#125;</span><br></code></pre></td></tr></table></figure>

<p>最直接的方法就是使用 <code>for</code> 循环将每个文件读入并存为 <code>list</code> 的一个元素，接着可以使用 <code>dplyr</code> 的 <code>bind_rows</code> 函数进行合并：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs R">files <span class="hljs-operator">&lt;-</span>  list.files<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;test/&quot;</span><span class="hljs-punctuation">,</span>pattern<span class="hljs-operator">=</span><span class="hljs-string">&quot;*.csv&quot;</span><span class="hljs-punctuation">,</span>full.names <span class="hljs-operator">=</span> <span class="hljs-built_in">T</span><span class="hljs-punctuation">)</span><br>res <span class="hljs-operator">&lt;-</span> vector<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;list&quot;</span><span class="hljs-punctuation">)</span><br><span class="hljs-keyword">for</span> <span class="hljs-punctuation">(</span>i <span class="hljs-keyword">in</span> <span class="hljs-built_in">seq_along</span><span class="hljs-punctuation">(</span>files<span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">&#123;</span><br>  res<span class="hljs-punctuation">[[</span>i<span class="hljs-punctuation">]</span><span class="hljs-punctuation">]</span> <span class="hljs-operator">&lt;-</span> read.csv<span class="hljs-punctuation">(</span>files<span class="hljs-punctuation">[</span>i<span class="hljs-punctuation">]</span><span class="hljs-punctuation">)</span><br><span class="hljs-punctuation">&#125;</span><br>res <span class="hljs-operator">&lt;-</span> dplyr<span class="hljs-operator">::</span>bind_rows<span class="hljs-punctuation">(</span>res<span class="hljs-punctuation">)</span><br><span class="hljs-comment">##也可以使用 data.table 的 rbindlist 函数</span><br><span class="hljs-comment">##res &lt;- data.table::rbindlist(res)</span><br></code></pre></td></tr></table></figure>

<p>能用 <code>for</code> 循环的地方就可以使用 <code>apply</code> 簇函数进行替代简化：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs R">library<span class="hljs-punctuation">(</span>dplyr<span class="hljs-punctuation">)</span><br>files <span class="hljs-operator">&lt;-</span>  list.files<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;test/&quot;</span><span class="hljs-punctuation">,</span>pattern<span class="hljs-operator">=</span><span class="hljs-string">&quot;*.csv&quot;</span><span class="hljs-punctuation">,</span>full.names <span class="hljs-operator">=</span> <span class="hljs-built_in">T</span><span class="hljs-punctuation">)</span><br>res <span class="hljs-operator">&lt;-</span> lapply<span class="hljs-punctuation">(</span>files<span class="hljs-punctuation">,</span> read.csv<span class="hljs-punctuation">)</span> <span class="hljs-operator">%&gt;%</span> <br>  bind_rows<span class="hljs-punctuation">(</span>.<span class="hljs-punctuation">)</span><br></code></pre></td></tr></table></figure>

<p>也可以使用 <code>do.call</code> 结合 <code>rbind</code> 直接将读入的数据按行合并：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs R">files <span class="hljs-operator">&lt;-</span>  list.files<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;test/&quot;</span><span class="hljs-punctuation">,</span>pattern<span class="hljs-operator">=</span><span class="hljs-string">&quot;*.csv&quot;</span><span class="hljs-punctuation">,</span>full.names <span class="hljs-operator">=</span> <span class="hljs-built_in">T</span><span class="hljs-punctuation">)</span><br>res <span class="hljs-operator">&lt;-</span> do.call<span class="hljs-punctuation">(</span>rbind<span class="hljs-punctuation">,</span>lapply<span class="hljs-punctuation">(</span>files<span class="hljs-punctuation">,</span>read.csv<span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><br></code></pre></td></tr></table></figure>

<h3 id="如何在-Shell-中并行"><a href="#如何在-Shell-中并行" class="headerlink" title="如何在 Shell 中并行"></a>如何在 Shell 中并行</h3><p>首先需要安装 <code>GNU parallel</code>:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs shell">wget http://ftp.gnu.org/gnu/parallel/parallel-latest.tar.bz2<br>tar xjf parallel-latest.tar.bz2<br>cd parallel-20211022/<br>./configure --prefix=$HOME<br>make<br>make install<br></code></pre></td></tr></table></figure>

<p>最简单的使用方法就是：<code>cat list | parallel do_something | process_output</code>，可以通过 <code>-j</code> 参数来指定需要调用的核数：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-meta">#!/bin/bash</span><br><span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> `<span class="hljs-built_in">cat</span> /home/wt/common_driver/data/hla.txt`<br><span class="hljs-keyword">do</span><br>  hla=$(<span class="hljs-built_in">echo</span> <span class="hljs-variable">$line</span> | awk -F<span class="hljs-string">&#x27;,&#x27;</span> <span class="hljs-string">&#x27;&#123;print $1&#125;&#x27;</span>)<br>  hla_alt=$(<span class="hljs-built_in">echo</span> <span class="hljs-variable">$line</span> | awk -F<span class="hljs-string">&#x27;,&#x27;</span> <span class="hljs-string">&#x27;&#123;print $2&#125;&#x27;</span>)<br>  <span class="hljs-built_in">cat</span> /home/wt/common_driver/data/pep8/files | parallel -j 15 netMHCpan -p /home/wt/common_driver/data/pep8/split/&#123;&#125; -BA -l 8 -xls -a <span class="hljs-variable">$hla</span> -xlsfile /home/wt/common_driver/data/pep8/results/<span class="hljs-variable">$&#123;hla_alt&#125;</span>_&#123;&#125;.xls<br><span class="hljs-keyword">done</span><br></code></pre></td></tr></table></figure>

<h2 id="Shell-如何按行把文件拼起来"><a href="#Shell-如何按行把文件拼起来" class="headerlink" title="Shell 如何按行把文件拼起来"></a>Shell 如何按行把文件拼起来</h2><p>使用 <code>column</code> 命令：<code>paste file1 file2 | column -s $&#39;\t&#39; -t</code>, <code>-s</code> 表示分割符<a target="_blank" rel="noopener" href="https://linux.die.net/man/1/column">column(1): columnate lists - Linux man page (die.net)</a></p>
<h2 id="启动-Rstudio-server-报错"><a href="#启动-Rstudio-server-报错" class="headerlink" title="启动 Rstudio-server 报错"></a>启动 Rstudio-server 报错</h2><p>先 <code>rstudio-server stop</code> 再 <code>rstudio-server start</code> 报错：</p>
<p><img src="https://picgo-wutao.oss-cn-shanghai.aliyuncs.com/image-20220228084453167.png" srcset="/img/loading.gif" lazyload></p>
<p>找到占用8787端口的进程，然后kill掉：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell">lsof -i tcp:8787<br>sudo kill -9 PID<br></code></pre></td></tr></table></figure>

<p>接着重启 Rstudio 就可以了：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">rstudio-server restart<br></code></pre></td></tr></table></figure>

<p><img src="https://picgo-wutao.oss-cn-shanghai.aliyuncs.com/image-20220228084711556.png" srcset="/img/loading.gif" lazyload></p>
<h2 id="安装-tensorflow-额外包-CURL-CA-BUNDLE-设置"><a href="#安装-tensorflow-额外包-CURL-CA-BUNDLE-设置" class="headerlink" title="安装 tensorflow 额外包 CURL_CA_BUNDLE 设置"></a>安装 tensorflow 额外包 CURL_CA_BUNDLE 设置</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell">install.packages(&quot;tensorflow&quot;)<br>tensorflow::install_tensorflow(extra_packages=&#x27;tensorflow-probability&#x27;)<br></code></pre></td></tr></table></figure>

<p>报错：</p>
<p><img src="https://picgo-wutao.oss-cn-shanghai.aliyuncs.com/image-20220225122450-ebc8ilw.png" srcset="/img/loading.gif" lazyload></p>
<p>安装官方的指示：</p>
<hr>
<p>Hi, can you please follow the instructions on the Issue Template that, I believe, was presented to you when you filed the issue? Issue template reproduced here for convenience:</p>
<p>Many installation issues are resolved by running the following in a <strong>fresh R session</strong> (you can restart R in Rstudio with Ctrl+Shift+F10):</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs r"><span class="hljs-comment">#installthedevelopmentversionofpackages,incasethe</span><br><span class="hljs-comment">#issueisalreadyfixedbutnotonCRANyet.</span><br>install.packages<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;remotes&quot;</span><span class="hljs-punctuation">)</span><br>remotes<span class="hljs-operator">::</span>install_github<span class="hljs-punctuation">(</span>sprintf<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;rstudio/%s&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-string">&quot;reticulate&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;tensorflow&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;keras&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><br>reticulate<span class="hljs-operator">::</span>miniconda_uninstall<span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span><span class="hljs-comment">#startwithablankslate</span><br>reticulate<span class="hljs-operator">::</span>install_miniconda<span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span><br>keras<span class="hljs-operator">::</span>install_keras<span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span><br></code></pre></td></tr></table></figure>

<p>Test to see if installation was successful.</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs r">tensorflow<span class="hljs-operator">::</span>as_tensor<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;HelloWorld&quot;</span><span class="hljs-punctuation">)</span><br></code></pre></td></tr></table></figure>

<p>If the above snippet succeeded and you saw something like <code>tf.Tensor(b&#39;Hello World&#39;, shape=(), dtype=string)</code>, then 🎉, you’ve successfully installed Tensorflow.</p>
<p>If the above installation failed, please gather some diagnostic info:</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs r">reticulate<span class="hljs-operator">::</span>py_config<span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span><br>tensorflow<span class="hljs-operator">::</span>tf_config<span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span><br>reticulate<span class="hljs-operator">::</span>import<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;tensorflow&quot;</span><span class="hljs-punctuation">)</span><br>reticulate<span class="hljs-operator">::</span>py_last_error<span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span><br>sessionInfo<span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span><br></code></pre></td></tr></table></figure>

<p>Please copy and paste the FULL OUTPUT of running all three snippets, and be sure to enclose the output lines with three backticks (&#96;&#96;&#96;) for monospace formatting.</p>
<hr>
<p>但是重新安装 conda 时出错：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs r"><span class="hljs-operator">&gt;</span> reticulate<span class="hljs-operator">::</span>install_miniconda<span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span><br><span class="hljs-operator">*</span> Installing Miniconda <span class="hljs-operator">-</span><span class="hljs-operator">-</span> please wait a moment ...<br><span class="hljs-operator">*</span> Downloading <span class="hljs-string">&#x27;https://repo.anaconda.com/miniconda/Miniconda3-latest-Linux-x86_64.sh&#x27;</span> ...<br>trying URL <span class="hljs-string">&#x27;https://repo.anaconda.com/miniconda/Miniconda3-latest-Linux-x86_64.sh&#x27;</span><br>Error <span class="hljs-keyword">in</span> download.file<span class="hljs-punctuation">(</span>url<span class="hljs-punctuation">,</span> destfile <span class="hljs-operator">=</span> installer<span class="hljs-punctuation">,</span> mode <span class="hljs-operator">=</span> <span class="hljs-string">&quot;wb&quot;</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">:</span> <br>  cannot open URL <span class="hljs-string">&#x27;https://repo.anaconda.com/miniconda/Miniconda3-latest-Linux-x86_64.sh&#x27;</span><br>In addition<span class="hljs-operator">:</span> Warning message<span class="hljs-operator">:</span><br>In download.file<span class="hljs-punctuation">(</span>url<span class="hljs-punctuation">,</span> destfile <span class="hljs-operator">=</span> installer<span class="hljs-punctuation">,</span> mode <span class="hljs-operator">=</span> <span class="hljs-string">&quot;wb&quot;</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">:</span><br>  URL <span class="hljs-string">&#x27;https://repo.anaconda.com/miniconda/Miniconda3-latest-Linux-x86_64.sh&#x27;</span><span class="hljs-operator">:</span> status was <span class="hljs-string">&#x27;Problem with the SSL CA cert (path? access rights?)&#x27;</span><br></code></pre></td></tr></table></figure>

<p>查看这个函数：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs r"><span class="hljs-operator">&gt;</span> reticulate<span class="hljs-operator">::</span>install_miniconda<br><span class="hljs-keyword">function</span> <span class="hljs-punctuation">(</span>path <span class="hljs-operator">=</span> miniconda_path<span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> update <span class="hljs-operator">=</span> <span class="hljs-literal">TRUE</span><span class="hljs-punctuation">,</span> force <span class="hljs-operator">=</span> <span class="hljs-literal">FALSE</span><span class="hljs-punctuation">)</span> <br><span class="hljs-punctuation">&#123;</span><br>    check_forbidden_install<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;Miniconda&quot;</span><span class="hljs-punctuation">)</span><br>    <span class="hljs-keyword">if</span> <span class="hljs-punctuation">(</span>grepl<span class="hljs-punctuation">(</span><span class="hljs-string">&quot; &quot;</span><span class="hljs-punctuation">,</span> path<span class="hljs-punctuation">,</span> fixed <span class="hljs-operator">=</span> <span class="hljs-literal">TRUE</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span> <br>        stop<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;cannot install Miniconda into a path containing spaces&quot;</span><span class="hljs-punctuation">)</span><br>    install_miniconda_preflight<span class="hljs-punctuation">(</span>path<span class="hljs-punctuation">,</span> force<span class="hljs-punctuation">)</span><br>    message<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;* Installing Miniconda -- please wait a moment ...&quot;</span><span class="hljs-punctuation">)</span><br>    url <span class="hljs-operator">&lt;-</span> miniconda_installer_url<span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span><br>    installer <span class="hljs-operator">&lt;-</span> miniconda_installer_download<span class="hljs-punctuation">(</span>url<span class="hljs-punctuation">)</span><br>    miniconda_installer_run<span class="hljs-punctuation">(</span>installer<span class="hljs-punctuation">,</span> update<span class="hljs-punctuation">,</span> path<span class="hljs-punctuation">)</span><br>    ok <span class="hljs-operator">&lt;-</span> miniconda_exists<span class="hljs-punctuation">(</span>path<span class="hljs-punctuation">)</span> <span class="hljs-operator">&amp;&amp;</span> miniconda_test<span class="hljs-punctuation">(</span>path<span class="hljs-punctuation">)</span><br>    <span class="hljs-keyword">if</span> <span class="hljs-punctuation">(</span><span class="hljs-operator">!</span>ok<span class="hljs-punctuation">)</span> <br>        stopf<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;Miniconda installation failed [unknown reason]&quot;</span><span class="hljs-punctuation">)</span><br>    <span class="hljs-keyword">if</span> <span class="hljs-punctuation">(</span>update<span class="hljs-punctuation">)</span> <br>        miniconda_update<span class="hljs-punctuation">(</span>path<span class="hljs-punctuation">)</span><br>    conda <span class="hljs-operator">&lt;-</span> miniconda_conda<span class="hljs-punctuation">(</span>path<span class="hljs-punctuation">)</span><br>    python <span class="hljs-operator">&lt;-</span> miniconda_python_package<span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span><br>    conda_create<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;r-reticulate&quot;</span><span class="hljs-punctuation">,</span> packages <span class="hljs-operator">=</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span>python<span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;numpy&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> <br>        conda <span class="hljs-operator">=</span> conda<span class="hljs-punctuation">)</span><br>    messagef<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;* Miniconda has been successfully installed at %s.&quot;</span><span class="hljs-punctuation">,</span> <br>        pretty_path<span class="hljs-punctuation">(</span>path<span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><br>    path<br><span class="hljs-punctuation">&#125;</span><br></code></pre></td></tr></table></figure>

<p>关键在于这3句：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs r">url <span class="hljs-operator">&lt;-</span> miniconda_installer_url<span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span><br>installer <span class="hljs-operator">&lt;-</span> miniconda_installer_download<span class="hljs-punctuation">(</span>url<span class="hljs-punctuation">)</span><br>miniconda_installer_run<span class="hljs-punctuation">(</span>installer<span class="hljs-punctuation">,</span> update<span class="hljs-punctuation">,</span> path<span class="hljs-punctuation">)</span><br></code></pre></td></tr></table></figure>

<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs r"><span class="hljs-operator">&gt;</span> url <span class="hljs-operator">&lt;-</span> reticulate<span class="hljs-operator">:::</span>miniconda_installer_url<span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span><br><span class="hljs-operator">&gt;</span> url<br><span class="hljs-punctuation">[</span><span class="hljs-number">1</span><span class="hljs-punctuation">]</span> <span class="hljs-string">&quot;https://repo.anaconda.com/miniconda/Miniconda3-latest-Linux-x86_64.sh&quot;</span><br><br><span class="hljs-operator">&gt;</span> reticulate<span class="hljs-operator">:::</span>miniconda_installer_download<br><span class="hljs-keyword">function</span> <span class="hljs-punctuation">(</span>url<span class="hljs-punctuation">)</span> <br><span class="hljs-punctuation">&#123;</span><br>    installer <span class="hljs-operator">&lt;-</span> file.path<span class="hljs-punctuation">(</span>tempdir<span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> basename<span class="hljs-punctuation">(</span>url<span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><br>    <span class="hljs-keyword">if</span> <span class="hljs-punctuation">(</span>file.exists<span class="hljs-punctuation">(</span>installer<span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span> <br>        <span class="hljs-built_in">return</span><span class="hljs-punctuation">(</span>installer<span class="hljs-punctuation">)</span><br>    messagef<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;* Downloading %s ...&quot;</span><span class="hljs-punctuation">,</span> shQuote<span class="hljs-punctuation">(</span>url<span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><br>    status <span class="hljs-operator">&lt;-</span> download.file<span class="hljs-punctuation">(</span>url<span class="hljs-punctuation">,</span> destfile <span class="hljs-operator">=</span> installer<span class="hljs-punctuation">,</span> mode <span class="hljs-operator">=</span> <span class="hljs-string">&quot;wb&quot;</span><span class="hljs-punctuation">)</span><br>    <span class="hljs-keyword">if</span> <span class="hljs-punctuation">(</span><span class="hljs-operator">!</span>file.exists<span class="hljs-punctuation">(</span>installer<span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span> <span class="hljs-punctuation">&#123;</span><br>        fmt <span class="hljs-operator">&lt;-</span> <span class="hljs-string">&quot;download of Miniconda installer failed [status = %i]&quot;</span><br>        stopf<span class="hljs-punctuation">(</span>fmt<span class="hljs-punctuation">,</span> status<span class="hljs-punctuation">)</span><br>    <span class="hljs-punctuation">&#125;</span><br>    installer<br><span class="hljs-punctuation">&#125;</span><br></code></pre></td></tr></table></figure>

<p>所以 <code>miniconda_installer_download </code> 返回的就是 miniconda 的 sh 文件的路劲，我们提供一下应该就可以了：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br></pre></td><td class="code"><pre><code class="hljs r"><span class="hljs-operator">&gt;</span> path <span class="hljs-operator">=</span> miniconda_path<span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span><br><span class="hljs-operator">&gt;</span> update <span class="hljs-operator">=</span> <span class="hljs-literal">TRUE</span><br><span class="hljs-operator">&gt;</span> installer <span class="hljs-operator">&lt;-</span> <span class="hljs-string">&quot;/home/wt/software/Miniconda3-latest-Linux-x86_64.sh&quot;</span><br><span class="hljs-operator">&gt;</span> reticulate<span class="hljs-operator">:::</span>miniconda_installer_run<span class="hljs-punctuation">(</span>installer<span class="hljs-punctuation">,</span> update<span class="hljs-punctuation">,</span> path<span class="hljs-punctuation">)</span><br>PREFIX<span class="hljs-operator">=</span><span class="hljs-operator">/</span>home<span class="hljs-operator">/</span>wt<span class="hljs-operator">/</span>.local<span class="hljs-operator">/</span>share<span class="hljs-operator">/</span>r<span class="hljs-operator">-</span>miniconda<br>Unpacking payload ...<br>Collecting package metadata <span class="hljs-punctuation">(</span>current_repodata.json<span class="hljs-punctuation">)</span><span class="hljs-operator">:</span> ...working... done                      <br>Solving environment<span class="hljs-operator">:</span> ...working... done<br><br><span class="hljs-comment">## Package Plan ##</span><br><br>  environment location<span class="hljs-operator">:</span> <span class="hljs-operator">/</span>home<span class="hljs-operator">/</span>wt<span class="hljs-operator">/</span>.local<span class="hljs-operator">/</span>share<span class="hljs-operator">/</span>r<span class="hljs-operator">-</span>miniconda<br><br>  added <span class="hljs-operator">/</span> updated specs<span class="hljs-operator">:</span><br>    <span class="hljs-operator">-</span> _libgcc_mutex<span class="hljs-operator">==</span><span class="hljs-number">0.1</span><span class="hljs-operator">=</span>main<br>    <span class="hljs-operator">-</span> _openmp_mutex<span class="hljs-operator">==</span><span class="hljs-number">4.5</span><span class="hljs-operator">=</span><span class="hljs-number">1</span>_gnu<br>    <span class="hljs-operator">-</span> brotlipy<span class="hljs-operator">==</span><span class="hljs-number">0.7</span>.0<span class="hljs-operator">=</span>py39h27cfd23_1003<br>    <span class="hljs-operator">-</span> ca<span class="hljs-operator">-</span>certificates<span class="hljs-operator">==</span><span class="hljs-number">2021.10</span>.26<span class="hljs-operator">=</span>h06a4308_2<br>    <span class="hljs-operator">-</span> certifi<span class="hljs-operator">==</span><span class="hljs-number">2021.10</span>.8<span class="hljs-operator">=</span>py39h06a4308_2<br>    <span class="hljs-operator">-</span> cffi<span class="hljs-operator">==</span><span class="hljs-number">1.15</span>.0<span class="hljs-operator">=</span>py39hd667e15_1<br>    <span class="hljs-operator">-</span> charset<span class="hljs-operator">-</span>normalizer<span class="hljs-operator">==</span><span class="hljs-number">2.0</span>.4<span class="hljs-operator">=</span>pyhd3eb1b0_0<br>    <span class="hljs-operator">-</span> conda<span class="hljs-operator">-</span>content<span class="hljs-operator">-</span>trust<span class="hljs-operator">==</span><span class="hljs-number">0.1</span>.1<span class="hljs-operator">=</span>pyhd3eb1b0_0<br>    <span class="hljs-operator">-</span> conda<span class="hljs-operator">-</span>package<span class="hljs-operator">-</span>handling<span class="hljs-operator">==</span><span class="hljs-number">1.7</span>.3<span class="hljs-operator">=</span>py39h27cfd23_1<br>    <span class="hljs-operator">-</span> conda<span class="hljs-operator">==</span><span class="hljs-number">4.11</span>.0<span class="hljs-operator">=</span>py39h06a4308_0<br>    <span class="hljs-operator">-</span> cryptography<span class="hljs-operator">==</span><span class="hljs-number">36.0</span>.0<span class="hljs-operator">=</span>py39h9ce1e76_0<br>    <span class="hljs-operator">-</span> idna<span class="hljs-operator">==</span><span class="hljs-number">3.3</span><span class="hljs-operator">=</span>pyhd3eb1b0_0<br>    <span class="hljs-operator">-</span> ld_impl_linux<span class="hljs-operator">-</span><span class="hljs-number">64</span><span class="hljs-operator">==</span><span class="hljs-number">2.35</span>.1<span class="hljs-operator">=</span>h7274673_9<br>    <span class="hljs-operator">-</span> libffi<span class="hljs-operator">==</span><span class="hljs-number">3.3</span><span class="hljs-operator">=</span>he6710b0_2<br>    <span class="hljs-operator">-</span> libgcc<span class="hljs-operator">-</span>ng<span class="hljs-operator">==</span><span class="hljs-number">9.3</span>.0<span class="hljs-operator">=</span>h5101ec6_17<br>    <span class="hljs-operator">-</span> libgomp<span class="hljs-operator">==</span><span class="hljs-number">9.3</span>.0<span class="hljs-operator">=</span>h5101ec6_17<br>    <span class="hljs-operator">-</span> libstdcxx<span class="hljs-operator">-</span>ng<span class="hljs-operator">==</span><span class="hljs-number">9.3</span>.0<span class="hljs-operator">=</span>hd4cf53a_17<br>    <span class="hljs-operator">-</span> ncurses<span class="hljs-operator">==</span><span class="hljs-number">6.3</span><span class="hljs-operator">=</span>h7f8727e_2<br>    <span class="hljs-operator">-</span> openssl<span class="hljs-operator">==</span><span class="hljs-number">1.1</span>.1m<span class="hljs-operator">=</span>h7f8727e_0<br>    <span class="hljs-operator">-</span> pip<span class="hljs-operator">==</span><span class="hljs-number">21.2</span>.4<span class="hljs-operator">=</span>py39h06a4308_0<br>    <span class="hljs-operator">-</span> pycosat<span class="hljs-operator">==</span><span class="hljs-number">0.6</span>.3<span class="hljs-operator">=</span>py39h27cfd23_0<br>    <span class="hljs-operator">-</span> pycparser<span class="hljs-operator">==</span><span class="hljs-number">2.21</span><span class="hljs-operator">=</span>pyhd3eb1b0_0<br>    <span class="hljs-operator">-</span> pyopenssl<span class="hljs-operator">==</span><span class="hljs-number">21.0</span>.0<span class="hljs-operator">=</span>pyhd3eb1b0_1<br>    <span class="hljs-operator">-</span> pysocks<span class="hljs-operator">==</span><span class="hljs-number">1.7</span>.1<span class="hljs-operator">=</span>py39h06a4308_0<br>    <span class="hljs-operator">-</span> python<span class="hljs-operator">==</span><span class="hljs-number">3.9</span>.7<span class="hljs-operator">=</span>h12debd9_1<br>    <span class="hljs-operator">-</span> readline<span class="hljs-operator">==</span><span class="hljs-number">8.1</span>.2<span class="hljs-operator">=</span>h7f8727e_1<br>    <span class="hljs-operator">-</span> requests<span class="hljs-operator">==</span><span class="hljs-number">2.27</span>.1<span class="hljs-operator">=</span>pyhd3eb1b0_0<br>    <span class="hljs-operator">-</span> ruamel_yaml<span class="hljs-operator">==</span><span class="hljs-number">0.15</span>.100<span class="hljs-operator">=</span>py39h27cfd23_0<br>    <span class="hljs-operator">-</span> setuptools<span class="hljs-operator">==</span><span class="hljs-number">58.0</span>.4<span class="hljs-operator">=</span>py39h06a4308_0<br>    <span class="hljs-operator">-</span> six<span class="hljs-operator">==</span><span class="hljs-number">1.16</span>.0<span class="hljs-operator">=</span>pyhd3eb1b0_0<br>    <span class="hljs-operator">-</span> sqlite<span class="hljs-operator">==</span><span class="hljs-number">3.37</span>.0<span class="hljs-operator">=</span>hc218d9a_0<br>    <span class="hljs-operator">-</span> tk<span class="hljs-operator">==</span><span class="hljs-number">8.6</span>.11<span class="hljs-operator">=</span>h1ccaba5_0<br>    <span class="hljs-operator">-</span> tqdm<span class="hljs-operator">==</span><span class="hljs-number">4.62</span>.3<span class="hljs-operator">=</span>pyhd3eb1b0_1<br>    <span class="hljs-operator">-</span> tzdata<span class="hljs-operator">==</span><span class="hljs-number">2021</span>e<span class="hljs-operator">=</span>hda174b7_0<br>    <span class="hljs-operator">-</span> urllib3<span class="hljs-operator">==</span><span class="hljs-number">1.26</span>.7<span class="hljs-operator">=</span>pyhd3eb1b0_0<br>    <span class="hljs-operator">-</span> wheel<span class="hljs-operator">==</span><span class="hljs-number">0.37</span>.1<span class="hljs-operator">=</span>pyhd3eb1b0_0<br>    <span class="hljs-operator">-</span> xz<span class="hljs-operator">==</span><span class="hljs-number">5.2</span>.5<span class="hljs-operator">=</span>h7b6447c_0<br>    <span class="hljs-operator">-</span> yaml<span class="hljs-operator">==</span><span class="hljs-number">0.2</span>.5<span class="hljs-operator">=</span>h7b6447c_0<br>    <span class="hljs-operator">-</span> zlib<span class="hljs-operator">==</span><span class="hljs-number">1.2</span>.11<span class="hljs-operator">=</span>h7f8727e_4<br><br><br>The following NEW packages will be INSTALLED<span class="hljs-operator">:</span><br><br>  _libgcc_mutex      pkgs<span class="hljs-operator">/</span>main<span class="hljs-operator">/</span>linux<span class="hljs-operator">-</span><span class="hljs-number">64</span><span class="hljs-operator">::</span>_libgcc_mutex<span class="hljs-operator">-</span><span class="hljs-number">0.1</span><span class="hljs-operator">-</span>main<br>  _openmp_mutex      pkgs<span class="hljs-operator">/</span>main<span class="hljs-operator">/</span>linux<span class="hljs-operator">-</span><span class="hljs-number">64</span><span class="hljs-operator">::</span>_openmp_mutex<span class="hljs-operator">-</span><span class="hljs-number">4.5</span><span class="hljs-operator">-</span><span class="hljs-number">1</span>_gnu<br>  brotlipy           pkgs<span class="hljs-operator">/</span>main<span class="hljs-operator">/</span>linux<span class="hljs-operator">-</span><span class="hljs-number">64</span><span class="hljs-operator">::</span>brotlipy<span class="hljs-operator">-</span><span class="hljs-number">0.7</span>.0<span class="hljs-operator">-</span>py39h27cfd23_1003<br>  ca<span class="hljs-operator">-</span>certificates    pkgs<span class="hljs-operator">/</span>main<span class="hljs-operator">/</span>linux<span class="hljs-operator">-</span><span class="hljs-number">64</span><span class="hljs-operator">::</span>ca<span class="hljs-operator">-</span>certificates<span class="hljs-operator">-</span><span class="hljs-number">2021.10</span>.26<span class="hljs-operator">-</span>h06a4308_2<br>  certifi            pkgs<span class="hljs-operator">/</span>main<span class="hljs-operator">/</span>linux<span class="hljs-operator">-</span><span class="hljs-number">64</span><span class="hljs-operator">::</span>certifi<span class="hljs-operator">-</span><span class="hljs-number">2021.10</span>.8<span class="hljs-operator">-</span>py39h06a4308_2<br>  cffi               pkgs<span class="hljs-operator">/</span>main<span class="hljs-operator">/</span>linux<span class="hljs-operator">-</span><span class="hljs-number">64</span><span class="hljs-operator">::</span>cffi<span class="hljs-operator">-</span><span class="hljs-number">1.15</span>.0<span class="hljs-operator">-</span>py39hd667e15_1<br>  charset<span class="hljs-operator">-</span>normalizer pkgs<span class="hljs-operator">/</span>main<span class="hljs-operator">/</span>noarch<span class="hljs-operator">::</span>charset<span class="hljs-operator">-</span>normalizer<span class="hljs-operator">-</span><span class="hljs-number">2.0</span>.4<span class="hljs-operator">-</span>pyhd3eb1b0_0<br>  conda              pkgs<span class="hljs-operator">/</span>main<span class="hljs-operator">/</span>linux<span class="hljs-operator">-</span><span class="hljs-number">64</span><span class="hljs-operator">::</span>conda<span class="hljs-operator">-</span><span class="hljs-number">4.11</span>.0<span class="hljs-operator">-</span>py39h06a4308_0<br>  conda<span class="hljs-operator">-</span>content<span class="hljs-operator">-</span>tru<span class="hljs-operator">~</span> pkgs<span class="hljs-operator">/</span>main<span class="hljs-operator">/</span>noarch<span class="hljs-operator">::</span>conda<span class="hljs-operator">-</span>content<span class="hljs-operator">-</span>trust<span class="hljs-operator">-</span><span class="hljs-number">0.1</span>.1<span class="hljs-operator">-</span>pyhd3eb1b0_0<br>  conda<span class="hljs-operator">-</span>package<span class="hljs-operator">-</span>han<span class="hljs-operator">~</span> pkgs<span class="hljs-operator">/</span>main<span class="hljs-operator">/</span>linux<span class="hljs-operator">-</span><span class="hljs-number">64</span><span class="hljs-operator">::</span>conda<span class="hljs-operator">-</span>package<span class="hljs-operator">-</span>handling<span class="hljs-operator">-</span><span class="hljs-number">1.7</span>.3<span class="hljs-operator">-</span>py39h27cfd23_1<br>  cryptography       pkgs<span class="hljs-operator">/</span>main<span class="hljs-operator">/</span>linux<span class="hljs-operator">-</span><span class="hljs-number">64</span><span class="hljs-operator">::</span>cryptography<span class="hljs-operator">-</span><span class="hljs-number">36.0</span>.0<span class="hljs-operator">-</span>py39h9ce1e76_0<br>  idna               pkgs<span class="hljs-operator">/</span>main<span class="hljs-operator">/</span>noarch<span class="hljs-operator">::</span>idna<span class="hljs-operator">-</span><span class="hljs-number">3.3</span><span class="hljs-operator">-</span>pyhd3eb1b0_0<br>  ld_impl_linux<span class="hljs-operator">-</span><span class="hljs-number">64</span>   pkgs<span class="hljs-operator">/</span>main<span class="hljs-operator">/</span>linux<span class="hljs-operator">-</span><span class="hljs-number">64</span><span class="hljs-operator">::</span>ld_impl_linux<span class="hljs-operator">-</span><span class="hljs-number">64</span><span class="hljs-operator">-</span><span class="hljs-number">2.35</span>.1<span class="hljs-operator">-</span>h7274673_9<br>  libffi             pkgs<span class="hljs-operator">/</span>main<span class="hljs-operator">/</span>linux<span class="hljs-operator">-</span><span class="hljs-number">64</span><span class="hljs-operator">::</span>libffi<span class="hljs-operator">-</span><span class="hljs-number">3.3</span><span class="hljs-operator">-</span>he6710b0_2<br>  libgcc<span class="hljs-operator">-</span>ng          pkgs<span class="hljs-operator">/</span>main<span class="hljs-operator">/</span>linux<span class="hljs-operator">-</span><span class="hljs-number">64</span><span class="hljs-operator">::</span>libgcc<span class="hljs-operator">-</span>ng<span class="hljs-operator">-</span><span class="hljs-number">9.3</span>.0<span class="hljs-operator">-</span>h5101ec6_17<br>  libgomp            pkgs<span class="hljs-operator">/</span>main<span class="hljs-operator">/</span>linux<span class="hljs-operator">-</span><span class="hljs-number">64</span><span class="hljs-operator">::</span>libgomp<span class="hljs-operator">-</span><span class="hljs-number">9.3</span>.0<span class="hljs-operator">-</span>h5101ec6_17<br>  libstdcxx<span class="hljs-operator">-</span>ng       pkgs<span class="hljs-operator">/</span>main<span class="hljs-operator">/</span>linux<span class="hljs-operator">-</span><span class="hljs-number">64</span><span class="hljs-operator">::</span>libstdcxx<span class="hljs-operator">-</span>ng<span class="hljs-operator">-</span><span class="hljs-number">9.3</span>.0<span class="hljs-operator">-</span>hd4cf53a_17<br>  ncurses            pkgs<span class="hljs-operator">/</span>main<span class="hljs-operator">/</span>linux<span class="hljs-operator">-</span><span class="hljs-number">64</span><span class="hljs-operator">::</span>ncurses<span class="hljs-operator">-</span><span class="hljs-number">6.3</span><span class="hljs-operator">-</span>h7f8727e_2<br>  openssl            pkgs<span class="hljs-operator">/</span>main<span class="hljs-operator">/</span>linux<span class="hljs-operator">-</span><span class="hljs-number">64</span><span class="hljs-operator">::</span>openssl<span class="hljs-operator">-</span><span class="hljs-number">1.1</span>.1m<span class="hljs-operator">-</span>h7f8727e_0<br>  pip                pkgs<span class="hljs-operator">/</span>main<span class="hljs-operator">/</span>linux<span class="hljs-operator">-</span><span class="hljs-number">64</span><span class="hljs-operator">::</span>pip<span class="hljs-operator">-</span><span class="hljs-number">21.2</span>.4<span class="hljs-operator">-</span>py39h06a4308_0<br>  pycosat            pkgs<span class="hljs-operator">/</span>main<span class="hljs-operator">/</span>linux<span class="hljs-operator">-</span><span class="hljs-number">64</span><span class="hljs-operator">::</span>pycosat<span class="hljs-operator">-</span><span class="hljs-number">0.6</span>.3<span class="hljs-operator">-</span>py39h27cfd23_0<br>  pycparser          pkgs<span class="hljs-operator">/</span>main<span class="hljs-operator">/</span>noarch<span class="hljs-operator">::</span>pycparser<span class="hljs-operator">-</span><span class="hljs-number">2.21</span><span class="hljs-operator">-</span>pyhd3eb1b0_0<br>  pyopenssl          pkgs<span class="hljs-operator">/</span>main<span class="hljs-operator">/</span>noarch<span class="hljs-operator">::</span>pyopenssl<span class="hljs-operator">-</span><span class="hljs-number">21.0</span>.0<span class="hljs-operator">-</span>pyhd3eb1b0_1<br>  pysocks            pkgs<span class="hljs-operator">/</span>main<span class="hljs-operator">/</span>linux<span class="hljs-operator">-</span><span class="hljs-number">64</span><span class="hljs-operator">::</span>pysocks<span class="hljs-operator">-</span><span class="hljs-number">1.7</span>.1<span class="hljs-operator">-</span>py39h06a4308_0<br>  python             pkgs<span class="hljs-operator">/</span>main<span class="hljs-operator">/</span>linux<span class="hljs-operator">-</span><span class="hljs-number">64</span><span class="hljs-operator">::</span>python<span class="hljs-operator">-</span><span class="hljs-number">3.9</span>.7<span class="hljs-operator">-</span>h12debd9_1<br>  readline           pkgs<span class="hljs-operator">/</span>main<span class="hljs-operator">/</span>linux<span class="hljs-operator">-</span><span class="hljs-number">64</span><span class="hljs-operator">::</span>readline<span class="hljs-operator">-</span><span class="hljs-number">8.1</span>.2<span class="hljs-operator">-</span>h7f8727e_1<br>  requests           pkgs<span class="hljs-operator">/</span>main<span class="hljs-operator">/</span>noarch<span class="hljs-operator">::</span>requests<span class="hljs-operator">-</span><span class="hljs-number">2.27</span>.1<span class="hljs-operator">-</span>pyhd3eb1b0_0<br>  ruamel_yaml        pkgs<span class="hljs-operator">/</span>main<span class="hljs-operator">/</span>linux<span class="hljs-operator">-</span><span class="hljs-number">64</span><span class="hljs-operator">::</span>ruamel_yaml<span class="hljs-operator">-</span><span class="hljs-number">0.15</span>.100<span class="hljs-operator">-</span>py39h27cfd23_0<br>  setuptools         pkgs<span class="hljs-operator">/</span>main<span class="hljs-operator">/</span>linux<span class="hljs-operator">-</span><span class="hljs-number">64</span><span class="hljs-operator">::</span>setuptools<span class="hljs-operator">-</span><span class="hljs-number">58.0</span>.4<span class="hljs-operator">-</span>py39h06a4308_0<br>  six                pkgs<span class="hljs-operator">/</span>main<span class="hljs-operator">/</span>noarch<span class="hljs-operator">::</span>six<span class="hljs-operator">-</span><span class="hljs-number">1.16</span>.0<span class="hljs-operator">-</span>pyhd3eb1b0_0<br>  sqlite             pkgs<span class="hljs-operator">/</span>main<span class="hljs-operator">/</span>linux<span class="hljs-operator">-</span><span class="hljs-number">64</span><span class="hljs-operator">::</span>sqlite<span class="hljs-operator">-</span><span class="hljs-number">3.37</span>.0<span class="hljs-operator">-</span>hc218d9a_0<br>  tk                 pkgs<span class="hljs-operator">/</span>main<span class="hljs-operator">/</span>linux<span class="hljs-operator">-</span><span class="hljs-number">64</span><span class="hljs-operator">::</span>tk<span class="hljs-operator">-</span><span class="hljs-number">8.6</span>.11<span class="hljs-operator">-</span>h1ccaba5_0<br>  tqdm               pkgs<span class="hljs-operator">/</span>main<span class="hljs-operator">/</span>noarch<span class="hljs-operator">::</span>tqdm<span class="hljs-operator">-</span><span class="hljs-number">4.62</span>.3<span class="hljs-operator">-</span>pyhd3eb1b0_1<br>  tzdata             pkgs<span class="hljs-operator">/</span>main<span class="hljs-operator">/</span>noarch<span class="hljs-operator">::</span>tzdata<span class="hljs-operator">-</span><span class="hljs-number">2021</span>e<span class="hljs-operator">-</span>hda174b7_0<br>  urllib3            pkgs<span class="hljs-operator">/</span>main<span class="hljs-operator">/</span>noarch<span class="hljs-operator">::</span>urllib3<span class="hljs-operator">-</span><span class="hljs-number">1.26</span>.7<span class="hljs-operator">-</span>pyhd3eb1b0_0<br>  wheel              pkgs<span class="hljs-operator">/</span>main<span class="hljs-operator">/</span>noarch<span class="hljs-operator">::</span>wheel<span class="hljs-operator">-</span><span class="hljs-number">0.37</span>.1<span class="hljs-operator">-</span>pyhd3eb1b0_0<br>  xz                 pkgs<span class="hljs-operator">/</span>main<span class="hljs-operator">/</span>linux<span class="hljs-operator">-</span><span class="hljs-number">64</span><span class="hljs-operator">::</span>xz<span class="hljs-operator">-</span><span class="hljs-number">5.2</span>.5<span class="hljs-operator">-</span>h7b6447c_0<br>  yaml               pkgs<span class="hljs-operator">/</span>main<span class="hljs-operator">/</span>linux<span class="hljs-operator">-</span><span class="hljs-number">64</span><span class="hljs-operator">::</span>yaml<span class="hljs-operator">-</span><span class="hljs-number">0.2</span>.5<span class="hljs-operator">-</span>h7b6447c_0<br>  zlib               pkgs<span class="hljs-operator">/</span>main<span class="hljs-operator">/</span>linux<span class="hljs-operator">-</span><span class="hljs-number">64</span><span class="hljs-operator">::</span>zlib<span class="hljs-operator">-</span><span class="hljs-number">1.2</span>.11<span class="hljs-operator">-</span>h7f8727e_4<br><br><br>Preparing transaction<span class="hljs-operator">:</span> ...working... done<br>Executing transaction<span class="hljs-operator">:</span> ...working... done<br>installation finished.<br></code></pre></td></tr></table></figure>

<p>但是安装<code>tensorflow::install_tensorflow(extra_packages=&#39;tensorflow-probability&#39;)</code> 的时候还是有同样的错误，找了半天，原来是环境变量的问题：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs r">usethis<span class="hljs-operator">::</span>edit_r_environ<span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span><br><span class="hljs-comment">##把CURL_CA_BUNDLE=/opt/microsoft/ropen/4.0.2/lib64/R/lib/microsoft-r-cacert.pem给注释掉</span><br></code></pre></td></tr></table></figure>

<p>接下来可以正常安装了：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs r">tensorflow<span class="hljs-operator">::</span>install_tensorflow<span class="hljs-punctuation">(</span>extra_packages<span class="hljs-operator">=</span><span class="hljs-string">&#x27;tensorflow-probability&#x27;</span><span class="hljs-punctuation">)</span><br><br><span class="hljs-operator">&gt;</span> tensorflow<span class="hljs-operator">::</span>tf_config<span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span><br><span class="hljs-number">2022</span><span class="hljs-operator">-</span><span class="hljs-number">03</span><span class="hljs-operator">-</span><span class="hljs-number">03</span> <span class="hljs-number">19</span><span class="hljs-operator">:</span><span class="hljs-number">34</span><span class="hljs-operator">:</span><span class="hljs-number">09.642406</span><span class="hljs-operator">:</span> W tensorflow<span class="hljs-operator">/</span>stream_executor<span class="hljs-operator">/</span>platform<span class="hljs-operator">/</span>default<span class="hljs-operator">/</span>dso_loader.cc<span class="hljs-operator">:</span><span class="hljs-number">64</span><span class="hljs-punctuation">]</span> Could not load dynamic library <span class="hljs-string">&#x27;libcudart.so.11.0&#x27;</span>; dlerror<span class="hljs-operator">:</span> libcudart.so.11.0<span class="hljs-operator">:</span> cannot open shared object file<span class="hljs-operator">:</span> No such file or directory; LD_LIBRARY_PATH<span class="hljs-operator">:</span> <span class="hljs-operator">/</span>home<span class="hljs-operator">/</span>data<span class="hljs-operator">/</span>R<span class="hljs-operator">/</span>R<span class="hljs-operator">-</span><span class="hljs-number">4.1</span>.0<span class="hljs-operator">/</span>lib<span class="hljs-operator">::</span><span class="hljs-operator">/</span>lib<span class="hljs-operator">:</span><span class="hljs-operator">/</span>usr<span class="hljs-operator">/</span>local<span class="hljs-operator">/</span>lib64<span class="hljs-operator">:</span><span class="hljs-operator">/</span>usr<span class="hljs-operator">/</span>lib<span class="hljs-operator">/</span>jvm<span class="hljs-operator">/</span>java<span class="hljs-operator">-</span><span class="hljs-number">1.8</span>.0<span class="hljs-operator">-</span>openjdk<span class="hljs-operator">-</span><span class="hljs-number">1.8</span>.0.292.b10<span class="hljs-operator">-</span><span class="hljs-number">1.</span>el7_9.x86_64<span class="hljs-operator">/</span>jre<span class="hljs-operator">/</span>lib<span class="hljs-operator">/</span>amd64<span class="hljs-operator">/</span>server<span class="hljs-operator">:</span><span class="hljs-operator">/</span>usr<span class="hljs-operator">/</span>local<span class="hljs-operator">/</span>lib<br><span class="hljs-number">2022</span><span class="hljs-operator">-</span><span class="hljs-number">03</span><span class="hljs-operator">-</span><span class="hljs-number">03</span> <span class="hljs-number">19</span><span class="hljs-operator">:</span><span class="hljs-number">34</span><span class="hljs-operator">:</span><span class="hljs-number">09.642611</span><span class="hljs-operator">:</span> I tensorflow<span class="hljs-operator">/</span>stream_executor<span class="hljs-operator">/</span>cuda<span class="hljs-operator">/</span>cudart_stub.cc<span class="hljs-operator">:</span><span class="hljs-number">29</span><span class="hljs-punctuation">]</span> Ignore above cudart dlerror <span class="hljs-keyword">if</span> you do not have a GPU set up on your machine.<br>Loaded Tensorflow version <span class="hljs-number">2.8</span>.0<br>TensorFlow v2.8.0 <span class="hljs-punctuation">(</span><span class="hljs-operator">~</span><span class="hljs-operator">/</span>miniconda3<span class="hljs-operator">/</span>lib<span class="hljs-operator">/</span>python3.9<span class="hljs-operator">/</span>site<span class="hljs-operator">-</span>packages<span class="hljs-operator">/</span>tensorflow<span class="hljs-punctuation">)</span><br>Python v3.9 <span class="hljs-punctuation">(</span><span class="hljs-operator">~</span><span class="hljs-operator">/</span>miniconda3<span class="hljs-operator">/</span>bin<span class="hljs-operator">/</span>python<span class="hljs-punctuation">)</span><br><br><span class="hljs-comment">#devtools::install_github(&quot;Irrationone/cellassign&quot;) 网不行</span><br>BiocManager<span class="hljs-operator">::</span>install<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;scran&quot;</span><span class="hljs-punctuation">)</span><br>install.packages<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;~/software/cellassign/&quot;</span><span class="hljs-punctuation">,</span>repos<span class="hljs-operator">=</span><span class="hljs-literal">NULL</span><span class="hljs-punctuation">,</span>type<span class="hljs-operator">=</span><span class="hljs-string">&quot;source&quot;</span><span class="hljs-punctuation">)</span><br></code></pre></td></tr></table></figure>



<h2 id="安装-magick-没有-Magick-pc"><a href="#安装-magick-没有-Magick-pc" class="headerlink" title="安装 magick 没有 Magick++.pc"></a>安装 magick 没有 Magick++.pc</h2><p>在安装 <code>UniprotR</code> 时会安装依赖包 <code>magick</code>, 报错信息：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs shell">* installing *source* package ‘magick’ ...<br>** package ‘magick’ successfully unpacked and MD5 sums checked<br>** using staged installation<br>Package Magick++ was not found in the pkg-config search path.<br>Perhaps you should add the directory containing `Magick++.pc&#x27;<br>to the PKG_CONFIG_PATH environment variable<br>No package &#x27;Magick++&#x27; found<br>Using PKG_CFLAGS=<br>Using PKG_LIBS=-lMagick++-6.Q16<br>--------------------------- [ANTICONF] --------------------------------<br>Configuration failed to find the Magick++ library. Try installing:<br> - deb: libmagick++-dev (Debian, Ubuntu)<br> - rpm: ImageMagick-c++-devel (Fedora, CentOS, RHEL)<br> - csw: imagemagick_dev (Solaris)<br> - brew imagemagick@6 (MacOS)<br>For Ubuntu versions Trusty (14.04) and Xenial (16.04) use our PPA:<br>   sudo add-apt-repository -y ppa:cran/imagemagick<br>   sudo apt-get update<br>   sudo apt-get install -y libmagick++-dev<br>If Magick++ is already installed, check that &#x27;pkg-config&#x27; is in your<br>PATH and PKG_CONFIG_PATH contains a Magick++.pc file. If pkg-config<br>is unavailable you can set INCLUDE_DIR and LIB_DIR manually via:<br>R CMD INSTALL --configure-vars=&#x27;INCLUDE_DIR=... LIB_DIR=...&#x27;<br>-------------------------- [ERROR MESSAGE] ---------------------------<br>&lt;stdin&gt;:1:10: fatal error: Magick++.h: No such file or directory<br>compilation terminated.<br>--------------------------------------------------------------------<br>ERROR: configuration failed for package ‘magick’<br>* removing ‘/home/data/public/R/library/magick’<br>Warning in install.packages :<br>  installation of package ‘magick’ had non-zero exit status<br></code></pre></td></tr></table></figure>

<p>安装 <code>ImageMagick</code>：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">yum install  ImageMagick-devel ImageMagick-c++-devel<br></code></pre></td></tr></table></figure>

<p>网不行，从源码安装：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell">git clone https://github.com/ImageMagick/ImageMagick.git ImageMagick-7.1.0<br>cd ImageMagick-7.1.0<br></code></pre></td></tr></table></figure>

<p>编译：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs shell">sudo ./configure<br>[sudo] password for wt: <br>checking build system type... x86_64-pc-linux-gnu<br>checking host system type... x86_64-pc-linux-gnu<br>checking target system type... x86_64-pc-linux-gnu<br>checking for a BSD-compatible install... /bin/install -c<br>checking whether build environment is sane... yes<br>checking for a thread-safe mkdir -p... /bin/mkdir -p<br>checking for gawk... gawk<br>checking whether make sets $(MAKE)... yes<br>checking whether make supports nested variables... yes<br>checking whether UID &#x27;0&#x27; is supported by ustar format... yes<br>checking whether GID &#x27;0&#x27; is supported by ustar format... yes<br>checking how to create a ustar tar archive... gnutar<br>checking whether make supports nested variables... (cached) yes<br>Configuring ImageMagick 7.1.0-26<br>checking whether build environment is sane... yes<br>checking whether make supports the include directive... yes (GNU style)<br>checking for gcc... gcc<br>checking whether the C compiler works... no<br>configure: error: in `/home/data/public/ImageMagick-7.1.0-26&#x27;:<br>configure: error: C compiler cannot create executables<br>See `config.log&#x27; for more details<br></code></pre></td></tr></table></figure>

<p>查看 <code>config.log</code> 发现找不到共享库 <code>error while loading shared libraries: libisl.so.15: cannot open shared object file</code>，但是LD_LIBRARY_PATH已经添加了（这个库在 <code>/usr/local/lib</code> 中，这个路径已经是LD_LIBRARY_PATH了，但是就是找不到），采用第二种方法：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs shell">cat /etc/ld.so.conf<br><span class="hljs-meta prompt_">#</span><span class="language-bash">include ld.so.conf.d/*.conf</span><br><span class="hljs-meta prompt_">#</span><span class="language-bash">include /usr/local/lib</span><br>cd /etc/ld.so.conf.d<br>sudo me.conf<br><span class="hljs-meta prompt_">#</span><span class="language-bash"><span class="hljs-comment">#把 /usr/local/lib 添加到me.conf</span></span><br>sudo ldconfig<br></code></pre></td></tr></table></figure>

<p>然后就可以编译安装了：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs shell">sudo ./configure<br>sudo make<br>sudo make install <br></code></pre></td></tr></table></figure>

<p>还是会报错，确实没有 <code>Magick++.pc</code>:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">Perhaps you should add the directory containing `Magick++.pc&#x27;<br></code></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://www.fujieace.com/kali-linux/pkg_config_path.html">pkg_config_path 环境变量设置 教程 - 付杰博客 (fujieace.com)</a></p>
<p>先用conda安装，然后把<code>Magick++.pc</code>所在的路径添加到<code>PKG_CONFIG_PATH</code> 环境变量（.Renviron）中:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs shell">conda install -c conda-forge imagemagick<br>cd miniconda3/<br>find Magick++.pc *<br><span class="hljs-meta prompt_">#</span><span class="language-bash">./lib/pkgconfig/Magick++.pc</span><br><span class="hljs-meta prompt_">#</span><span class="language-bash">./pkgs/imagemagick-7.0.11_14-pl5320hb118871_0/lib/pkgconfig/Magick++.pc</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">bash 中 添加<span class="hljs-built_in">export</span> PKG_CONFIG_PATH=/home/wt/miniconda3/lib/pkgconfig:<span class="hljs-variable">$PKG_CONFIG_PATH</span></span><br>usethis::edit_r_environ()<br><span class="hljs-meta prompt_">#</span><span class="language-bash">添加 PKG_CONFIG_PATH=/home/wt/miniconda3/lib/pkgconfig</span><br>install.packages(&quot;~/software/magick_2.7.3.tar.gz&quot;,repos=NULL,type=&quot;source&quot;)<br></code></pre></td></tr></table></figure>



<h2 id="如何使用-MobaXterm-jupyter-lab-实现远程连接"><a href="#如何使用-MobaXterm-jupyter-lab-实现远程连接" class="headerlink" title="如何使用 MobaXterm + jupyter lab 实现远程连接"></a>如何使用 MobaXterm + jupyter lab 实现远程连接</h2><ol>
<li><p><code>jupyter-lab --generate-config</code> 生成配置文件</p>
</li>
<li><p>生成密码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> notebook.auth <span class="hljs-keyword">import</span> passwd<br>passwd():<br></code></pre></td></tr></table></figure>
</li>
<li><p>修改配置文件：</p>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs ini"><span class="hljs-attr">c.ServerApp.allow_remote_access</span> = <span class="hljs-literal">True</span><br><span class="hljs-attr">c.ServerApp.ip</span> = <span class="hljs-string">&#x27;*&#x27;</span><br><span class="hljs-attr">c.ServerApp.password</span> = <span class="hljs-string">&#x27;刚刚生成的序列&#x27;</span><br></code></pre></td></tr></table></figure>
</li>
<li><p>后台运行 jupyter-lab：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">nohup jupyter-lab --no-browser --port 8889 &gt; jupyter.log 2&gt;&amp;1 &amp;<br></code></pre></td></tr></table></figure></li>
</ol>
<p>接下来就可以使用 MobaXterm 进行端口转发，点击 Tunneling-New SHH tunnel</p>
<p><img src="https://picgo-wutao.oss-cn-shanghai.aliyuncs.com/img/image-20220329211156635.png" srcset="/img/loading.gif" lazyload></p>
<p>为了防止断连，可以在设置里面设定 ssh keepalive:</p>
<p><img src="https://picgo-wutao.oss-cn-shanghai.aliyuncs.com/img/image-20220329211307841.png" srcset="/img/loading.gif" lazyload></p>
<p>此时在浏览器中输入 <code>http://localhost:8899/</code> 就可以访问服务器的 jupyter-lab 了。</p>
<p>如果输入密码提示错误的话，可以先 kill 掉 jupyter-lab 的进程，然后 <code> jupyter-lab password</code> 修改密码，然后重新启动。</p>
<h2 id="如何删除文件中特定的列"><a href="#如何删除文件中特定的列" class="headerlink" title="如何删除文件中特定的列"></a>如何删除文件中特定的列</h2><p>[Deleting a Specific Line From a Text File in Command Line in Linux - SysTutorials](<a target="_blank" rel="noopener" href="https://www.systutorials.com/how-to-delete-a-specific-line-from-a-text-file-in-command-line-on-linux/#:~:text=Deleting">https://www.systutorials.com/how-to-delete-a-specific-line-from-a-text-file-in-command-line-on-linux/#:~:text=Deleting</a> a Specific Line From a Text File in Command Line in Linux,-Posted on Mar&amp;text&#x3D;You can use the “stream,filtering and transforming text” sed.&amp;text&#x3D;Here%2C -i means edit the,%3B immediately start next cycle”.)</p>
<h2 id="GEOquery-报错"><a href="#GEOquery-报错" class="headerlink" title="GEOquery 报错"></a>GEOquery 报错</h2><p>在运行 <code>getGEO</code> 下载 GEO 数据集时报错：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs R">Error <span class="hljs-keyword">in</span> `.rowNamesDF&lt;-`<span class="hljs-punctuation">(</span>x<span class="hljs-punctuation">,</span> value <span class="hljs-operator">=</span> value<span class="hljs-punctuation">)</span> <span class="hljs-operator">:</span> <span class="hljs-string">&#x27;row.names&#x27;</span>的长度不对<br></code></pre></td></tr></table></figure>

<p>根据 Github 上的解决方法：<a target="_blank" rel="noopener" href="https://github.com/seandavi/GEOquery/issues/114">Github issue</a>，在运行这句代码之前加上：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs R">readr<span class="hljs-operator">::</span>local_edition<span class="hljs-punctuation">(</span><span class="hljs-number">1</span><span class="hljs-punctuation">)</span><br></code></pre></td></tr></table></figure>

<p>原因是 readr 的版本问题。</p>
<h2 id="获取字符串长度时报错：invalid-multibyte-string"><a href="#获取字符串长度时报错：invalid-multibyte-string" class="headerlink" title="获取字符串长度时报错：invalid multibyte string"></a>获取字符串长度时报错：invalid multibyte string</h2><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs R"><span class="hljs-operator">&gt;</span> nchar<span class="hljs-punctuation">(</span>alldb<span class="hljs-operator">$</span>CDR3_a<span class="hljs-punctuation">)</span><br>Error <span class="hljs-keyword">in</span> nchar<span class="hljs-punctuation">(</span>alldb<span class="hljs-operator">$</span>CDR3_a<span class="hljs-punctuation">)</span> <span class="hljs-operator">:</span> invalid multibyte string<span class="hljs-punctuation">,</span> element <span class="hljs-number">1741</span><br><span class="hljs-operator">&gt;</span> alldb<span class="hljs-operator">$</span>CDR3_a<span class="hljs-punctuation">[</span><span class="hljs-number">1741</span><span class="hljs-punctuation">]</span><br><span class="hljs-punctuation">[</span><span class="hljs-number">1</span><span class="hljs-punctuation">]</span> <span class="hljs-string">&quot;LGTGNQFYF&lt;a0&gt;&quot;</span><br><span class="hljs-operator">&gt;</span> gsub<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;[&lt;a0&gt;]&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;&quot;</span><span class="hljs-punctuation">,</span>alldb<span class="hljs-operator">$</span>CDR3_a<span class="hljs-punctuation">[</span><span class="hljs-number">1741</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">)</span> <br><span class="hljs-punctuation">[</span><span class="hljs-number">1</span><span class="hljs-punctuation">]</span> <span class="hljs-string">&quot;LGTGNQFYF&lt;a0&gt;&quot;</span><br></code></pre></td></tr></table></figure>

<p>可以看到这个字符末尾有一个 <code>&lt;a0&gt;</code> ，在 Stackoverflow 上找到一个方法 <a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/4993837/r-invalid-multibyte-string">issue</a>：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs R"><span class="hljs-operator">&gt;</span> iconv<span class="hljs-punctuation">(</span>alldb<span class="hljs-operator">$</span>CDR3_a<span class="hljs-punctuation">[</span><span class="hljs-number">1741</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>from<span class="hljs-operator">=</span><span class="hljs-string">&quot;UTF-8&quot;</span><span class="hljs-punctuation">,</span> to<span class="hljs-operator">=</span><span class="hljs-string">&quot;UTF-8&quot;</span><span class="hljs-punctuation">,</span> sub<span class="hljs-operator">=</span><span class="hljs-string">&quot;&quot;</span><span class="hljs-punctuation">)</span><br><span class="hljs-punctuation">[</span><span class="hljs-number">1</span><span class="hljs-punctuation">]</span> <span class="hljs-string">&quot;LGTGNQFYF&quot;</span><br></code></pre></td></tr></table></figure>

<p>iconv 可以在不同的编码方式间进行转化，sub 参数就是将那些无法转化的字符转化成 sub 参数中的字符：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs R"><span class="hljs-operator">&gt;</span> iconv<span class="hljs-punctuation">(</span>alldb<span class="hljs-operator">$</span>CDR3_a<span class="hljs-punctuation">[</span><span class="hljs-number">1741</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>from<span class="hljs-operator">=</span><span class="hljs-string">&quot;UTF-8&quot;</span><span class="hljs-punctuation">,</span> to<span class="hljs-operator">=</span><span class="hljs-string">&quot;UTF-8&quot;</span><span class="hljs-punctuation">,</span> sub<span class="hljs-operator">=</span><span class="hljs-string">&quot;++&quot;</span><span class="hljs-punctuation">)</span><br><span class="hljs-punctuation">[</span><span class="hljs-number">1</span><span class="hljs-punctuation">]</span> <span class="hljs-string">&quot;LGTGNQFYF++&quot;</span><br></code></pre></td></tr></table></figure>

<h2 id="获取指定版本的-Ensembl-gene-ID-和-symbol-ID-的对应关系"><a href="#获取指定版本的-Ensembl-gene-ID-和-symbol-ID-的对应关系" class="headerlink" title="获取指定版本的 Ensembl gene ID 和 symbol ID 的对应关系"></a>获取指定版本的 Ensembl gene ID 和 symbol ID 的对应关系</h2><p>比如想要获取 Ensembl V75 版本的对应关系来转化 ENST 的 gene ID 到 gene symbol：</p>
<ul>
<li><p>进入 Ensembl 官网，在右边选择指定的版本：</p>
<p><img src="https://picgo-wutao.oss-cn-shanghai.aliyuncs.com/img/image-20220520221329570.png" srcset="/img/loading.gif" lazyload></p>
</li>
<li><p>选择下载</p>
<p><img src="https://picgo-wutao.oss-cn-shanghai.aliyuncs.com/img/image-20220520221709122.png" srcset="/img/loading.gif" lazyload></p>
</li>
<li><p>接着点击 <code>Customise your download</code> 就可以进入 Biomart 的界面：</p>
<p><img src="https://picgo-wutao.oss-cn-shanghai.aliyuncs.com/img/image-20220520221813333.png" srcset="/img/loading.gif" lazyload></p>
</li>
<li><p>根据需要选择：</p>
<p><img src="https://picgo-wutao.oss-cn-shanghai.aliyuncs.com/img/image-20220520221859751.png" srcset="/img/loading.gif" lazyload></p>
<p><img src="https://picgo-wutao.oss-cn-shanghai.aliyuncs.com/img/image-20220520221946118.png" srcset="/img/loading.gif" lazyload></p>
</li>
<li><p>点击 result 输出 tsv 文件就行了</p>
</li>
</ul>
<h2 id="展示好看的模型汇总表"><a href="#展示好看的模型汇总表" class="headerlink" title="展示好看的模型汇总表"></a>展示好看的模型汇总表</h2><p>使用 <code>gtsummary</code> 的 <code>tbl_regression</code> 的函数：</p>
 <figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs R">ibrary<span class="hljs-punctuation">(</span>gtsummary<span class="hljs-punctuation">)</span><br>m1 <span class="hljs-operator">&lt;-</span> glm<span class="hljs-punctuation">(</span>response <span class="hljs-operator">~</span> age <span class="hljs-operator">+</span> stage<span class="hljs-punctuation">,</span> trial<span class="hljs-punctuation">,</span> family <span class="hljs-operator">=</span> binomial<span class="hljs-punctuation">)</span><br>tbl_regression<span class="hljs-punctuation">(</span>m1<span class="hljs-punctuation">,</span> exponentiate <span class="hljs-operator">=</span> <span class="hljs-literal">TRUE</span><span class="hljs-punctuation">)</span><br></code></pre></td></tr></table></figure>

<p><img src="https://picgo-wutao.oss-cn-shanghai.aliyuncs.com/img/image-20220520222338550.png" srcset="/img/loading.gif" lazyload></p>
<p>更多可以参考<a target="_blank" rel="noopener" href="https://www.danieldsjoberg.com/gtsummary/articles/tbl_regression.html">文档</a>。</p>
<h2 id="展示混淆矩阵"><a href="#展示混淆矩阵" class="headerlink" title="展示混淆矩阵"></a>展示混淆矩阵</h2><p>使用 <a target="_blank" rel="noopener" href="https://cran.r-project.org/web/packages/cvms/vignettes/Creating_a_confusion_matrix.html">cvms</a> R 包：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs R">library<span class="hljs-punctuation">(</span>cvms<span class="hljs-punctuation">)</span><br>d_binomial <span class="hljs-operator">&lt;-</span> tibble<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;target&quot;</span> <span class="hljs-operator">=</span> rbinom<span class="hljs-punctuation">(</span><span class="hljs-number">100</span><span class="hljs-punctuation">,</span> <span class="hljs-number">1</span><span class="hljs-punctuation">,</span> <span class="hljs-number">0.7</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><br>                     <span class="hljs-string">&quot;prediction&quot;</span> <span class="hljs-operator">=</span> rbinom<span class="hljs-punctuation">(</span><span class="hljs-number">100</span><span class="hljs-punctuation">,</span> <span class="hljs-number">1</span><span class="hljs-punctuation">,</span> <span class="hljs-number">0.6</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><br>basic_table <span class="hljs-operator">&lt;-</span> table<span class="hljs-punctuation">(</span>d_binomial<span class="hljs-punctuation">)</span><span class="hljs-comment">##虽然用 table 也可以展示</span><br>basic_table<br><br>      prediction<br>target  <span class="hljs-number">0</span>  <span class="hljs-number">1</span><br>     <span class="hljs-number">0</span> <span class="hljs-number">14</span> <span class="hljs-number">13</span><br>     <span class="hljs-number">1</span> <span class="hljs-number">29</span> <span class="hljs-number">44</span><br><br>cfm <span class="hljs-operator">&lt;-</span> as_tibble<span class="hljs-punctuation">(</span>basic_table<span class="hljs-punctuation">)</span><br>cfm<br><br><span class="hljs-comment"># A tibble: 4 × 3</span><br>  target prediction     n<br>  <span class="hljs-operator">&lt;</span>chr<span class="hljs-operator">&gt;</span>  <span class="hljs-operator">&lt;</span>chr<span class="hljs-operator">&gt;</span>      <span class="hljs-operator">&lt;</span>int<span class="hljs-operator">&gt;</span><br><span class="hljs-number">1</span> <span class="hljs-number">0</span>      <span class="hljs-number">0</span>             <span class="hljs-number">14</span><br><span class="hljs-number">2</span> <span class="hljs-number">1</span>      <span class="hljs-number">0</span>             <span class="hljs-number">29</span><br><span class="hljs-number">3</span> <span class="hljs-number">0</span>      <span class="hljs-number">1</span>             <span class="hljs-number">13</span><br><span class="hljs-number">4</span> <span class="hljs-number">1</span>      <span class="hljs-number">1</span>             <span class="hljs-number">44</span><br><br>plot_confusion_matrix<span class="hljs-punctuation">(</span>cfm<span class="hljs-punctuation">,</span> <br>                      target_col <span class="hljs-operator">=</span> <span class="hljs-string">&quot;target&quot;</span><span class="hljs-punctuation">,</span> <br>                      prediction_col <span class="hljs-operator">=</span> <span class="hljs-string">&quot;prediction&quot;</span><span class="hljs-punctuation">,</span><br>                      counts_col <span class="hljs-operator">=</span> <span class="hljs-string">&quot;n&quot;</span><span class="hljs-punctuation">)</span><br></code></pre></td></tr></table></figure>

<img src="https://picgo-wutao.oss-cn-shanghai.aliyuncs.com/img/image-20220520222808732.png" srcset="/img/loading.gif" lazyload style="zoom:50%;" />


              
            </div>
            <hr/>
            <div>
              <div class="post-metas my-3">
  
    <div class="post-meta mr-3 d-flex align-items-center">
      <i class="iconfont icon-category"></i>
      

<span class="category-chains">
  
  
    
      <span class="category-chain">
        
  <a href="/categories/Linux/" class="category-chain-item">Linux</a>
  
  

      </span>
    
  
</span>

    </div>
  
  
    <div class="post-meta">
      <i class="iconfont icon-tags"></i>
      
        <a href="/tags/%E7%BC%96%E7%A8%8B/">#编程</a>
      
    </div>
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>Linux &amp; R Tips</div>
      <div>http://example.com/2021/08/05/linux_tips/</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>作者</div>
          <div>Wu Tao</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>发布于</div>
          <div>2021年8月5日</div>
        </div>
      
      
      <div class="license-meta-item">
        <div>许可协议</div>
        <div>
          
            
            
              <a target="_blank" href="https://creativecommons.org/licenses/by/4.0/">
              <span class="hint--top hint--rounded" aria-label="BY - 署名">
                <i class="iconfont icon-by"></i>
              </span>
              </a>
            
          
        </div>
      </div>
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2021/08/20/data_preprocess/" title="数据预处理">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">数据预处理</span>
                        <span class="visible-mobile">上一篇</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2021/07/21/pytorch_tutorial/" title="Pytorch 基础">
                        <span class="hidden-mobile">Pytorch 基础</span>
                        <span class="visible-mobile">下一篇</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
  <article id="comments" lazyload>
    
  <div id="waline"></div>
  <script type="text/javascript">
    Fluid.utils.loadComments('#waline', function() {
      Fluid.utils.createCssLink('https://cdn.jsdelivr.net/npm/@waline/client@0.14.8/dist/waline.min.css')
      Fluid.utils.createScript('https://cdn.jsdelivr.net/npm/@waline/client@0.14.8/dist/waline.min.js', function() {
        var options = Object.assign(
          {"serverURL":"https://comments-flax.vercel.app","path":"window.location.pathname","meta":["nick","mail","link"],"requiredMeta":["nick"],"lang":"zh-CN","emoji":["https://cdn.jsdelivr.net/gh/walinejs/emojis/weibo"],"dark":"html[data-user-color-scheme=\"dark\"]","wordLimit":0,"pageSize":10},
          {
            el: '#waline',
            path: window.location.pathname
          }
        )
        Waline.init(options);
        Fluid.utils.waitElementVisible('#waline .vcontent', () => {
          var imgSelector = '#waline .vcontent img:not(.vemoji)';
          Fluid.plugins.imageCaption(imgSelector);
          Fluid.plugins.fancyBox(imgSelector);
        })
      });
    });
  </script>
  <noscript>Please enable JavaScript to view the comments</noscript>


  </article>


          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header"><i class="iconfont icon-list"></i>&nbsp;目录</p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  


  
  








    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
    <div class="footer-content">
       <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> 
    </div>
  
  
    <div class="statistics">
  
  

  
    
      <span id="leancloud-site-pv-container" style="display: none">
        总访问量 
        <span id="leancloud-site-pv"></span>
         次
      </span>
    
    
      <span id="leancloud-site-uv-container" style="display: none">
        总访客数 
        <span id="leancloud-site-uv"></span>
         人
      </span>
    
    

  
</div>

  
  
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://cdn.jsdelivr.net/npm/nprogress@0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/nprogress@0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" ></script>
<script  src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>


  <script  src="https://cdn.jsdelivr.net/npm/typed.js@2.0.11/lib/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>




  

  

  

  

  

  

  
    
  




  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://cdn.jsdelivr.net/npm/tocbot@4.12.2/dist/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      headingSelector : CONFIG.toc.headingSelector || 'h1,h2,h3,h4,h5,h6',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      collapseDepth   : CONFIG.toc.collapseDepth || 0,
      scrollSmooth    : true,
      headingsOffset  : -boardTop
    });
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }
  });
</script>


  <script>
  (function() {
    var enableLang = CONFIG.code_language.enable && CONFIG.code_language.default;
    var enableCopy = CONFIG.copy_btn;
    if (!enableLang && !enableCopy) {
      return;
    }

    function getBgClass(ele) {
      return Fluid.utils.getBackgroundLightness(ele) >= 0 ? 'code-widget-light' : 'code-widget-dark';
    }

    var copyTmpl = '';
    copyTmpl += '<div class="code-widget">';
    copyTmpl += 'LANG';
    copyTmpl += '</div>';
    jQuery('.markdown-body pre').each(function() {
      var $pre = jQuery(this);
      if ($pre.find('code.mermaid').length > 0) {
        return;
      }
      if ($pre.find('span.line').length > 0) {
        return;
      }

      var lang = '';

      if (enableLang) {
        lang = CONFIG.code_language.default;
        if ($pre[0].children.length > 0 && $pre[0].children[0].classList.length >= 2 && $pre.children().hasClass('hljs')) {
          lang = $pre[0].children[0].classList[1];
        } else if ($pre[0].getAttribute('data-language')) {
          lang = $pre[0].getAttribute('data-language');
        } else if ($pre.parent().hasClass('sourceCode') && $pre[0].children.length > 0 && $pre[0].children[0].classList.length >= 2) {
          lang = $pre[0].children[0].classList[1];
          $pre.parent().addClass('code-wrapper');
        } else if ($pre.parent().hasClass('markdown-body') && $pre[0].classList.length === 0) {
          $pre.wrap('<div class="code-wrapper"></div>');
        }
        lang = lang.toUpperCase().replace('NONE', CONFIG.code_language.default);
      }
      $pre.append(copyTmpl.replace('LANG', lang).replace('code-widget">',
        getBgClass($pre[0]) + (enableCopy ? ' code-widget copy-btn" data-clipboard-snippet><i class="iconfont icon-copy"></i>' : ' code-widget">')));

      if (enableCopy) {
        Fluid.utils.createScript('https://cdn.jsdelivr.net/npm/clipboard@2.0.8/dist/clipboard.min.js', function() {
          var clipboard = new window.ClipboardJS('.copy-btn', {
            target: function(trigger) {
              var nodes = trigger.parentNode.childNodes;
              for (var i = 0; i < nodes.length; i++) {
                if (nodes[i].tagName === 'CODE') {
                  return nodes[i];
                }
              }
            }
          });
          clipboard.on('success', function(e) {
            e.clearSelection();
            e.trigger.innerHTML = e.trigger.innerHTML.replace('icon-copy', 'icon-success');
            setTimeout(function() {
              e.trigger.innerHTML = e.trigger.innerHTML.replace('icon-success', 'icon-copy');
            }, 2000);
          });
        });
      }
    });
  })();
</script>


  
<script>
  Fluid.utils.createScript('https://cdn.jsdelivr.net/npm/anchor-js@4.3.0/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));
  });
</script>


  
<script>
  Fluid.utils.createScript('https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  
      <script>
        MathJax = {
          tex    : {
            inlineMath: { '[+]': [['$', '$']] }
          },
          loader : {
            
          },
          options: {
            renderActions: {
              findScript    : [10, doc => {
                document.querySelectorAll('script[type^="math/tex"]').forEach(node => {
                  const display = !!node.type.match(/; *mode=display/);
                  const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display);
                  const text = document.createTextNode('');
                  node.parentNode.replaceChild(text, node);
                  math.start = { node: text, delim: '', n: 0 };
                  math.end = { node: text, delim: '', n: 0 };
                  doc.math.push(math);
                });
              }, '', false],
              insertedScript: [200, () => {
                document.querySelectorAll('mjx-container').forEach(node => {
                  let target = node.parentNode;
                  if (target.nodeName.toLowerCase() === 'li') {
                    target.parentNode.classList.add('has-jax');
                  }
                });
              }, '', false]
            }
          }
        };
      </script>
    

  <script  src="https://cdn.jsdelivr.net/npm/mathjax@3.1.2/es5/tex-mml-chtml.js" ></script>

  <script  src="/js/local-search.js" ></script>

  <script defer src="/js/leancloud.js" ></script>





<!-- 主题的启动项，将它保持在最底部 -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">博客在允许 JavaScript 运行的环境下浏览效果更佳</div>
  </noscript>
</body>
</html>
